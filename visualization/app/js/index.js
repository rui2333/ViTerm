!function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return r(n||t)},c,c.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,e,n){e.exports=t(3),e.exports.color=t(2)},{2:2,3:3}],2:[function(t,e,n){var i=e.exports=i||{};i.color=i.color||{},i.utils=i.utils||{},i.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),i=t.length-1;i>=0;i--)n=[t[i].apply(this,n)];return n[0]}},each:function(e,n,i){if(t&&e.forEach===t)e.forEach(n,i);else if(e.length===e.length+0){for(var r=0,o=e.length;r<o;r++)if(r in e&&n.call(i,e[r],r)===this.BREAK)return}else for(var r in e)if(n.call(i,e[r],r)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),i.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(i.utils.common),i.Color=i.color.Color=function(t,e,n,i){function r(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(a(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(a(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(s(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[e]=t}})}function a(t,n,r){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,r);else{if("HSV"!==t.__state.space)throw"Corrupted color state";i.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function s(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);i.extend(t.__state,{s:n.s,v:n.v}),i.isNaN(n.h)?i.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var u=function(){if(this.__state=t.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],i.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),r(u.prototype,"r",2),r(u.prototype,"g",1),r(u.prototype,"b",0),o(u.prototype,"h"),o(u.prototype,"s"),o(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),u}(i.color.interpret=function(t,e){var n,i,r=function(){i=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(r){if(r.litmus(t))return e.each(r.conversions,function(r,o){if(n=r.read(t),!1===i&&!1!==n)return i=n,n.conversionName=o,n.conversion=r,e.BREAK}),e.BREAK}),i},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return r}(i.color.toString,i.utils.common),i.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var i=Math.floor(t/60)%6,r=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-r*e),s=n*(1-(1-r)*e),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][i];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var i,r,o=Math.min(t,e,n),a=Math.max(t,e,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(r=s/a,i=t==a?(e-n)/s:e==a?2+(n-t)/s:4+(t-e)/s,i/=6,i<0&&(i+=1),{h:360*i,s:r,v:a/255})},rgb_to_hex:function(t,e,n){var i=this.hex_with_component(0,2,t);return i=this.hex_with_component(i,1,e),i=this.hex_with_component(i,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,i){return i<<(t=8*n)|e&~(255<<t)}}}(),i.color.toString,i.utils.common)},{}],3:[function(t,e,n){var i=e.exports=i||{};i.gui=i.gui||{},i.utils=i.utils||{},i.controllers=i.controllers||{},i.dom=i.dom||{},i.color=i.color||{},i.utils.css=function(){return{load:function(t,e){e=e||document;var n=e.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=t,e.getElementsByTagName("head")[0].appendChild(n)},inject:function(t,e){e=e||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(n)}}}(),i.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),i=t.length-1;i>=0;i--)n=[t[i].apply(this,n)];return n[0]}},each:function(e,n,i){if(t&&e.forEach===t)e.forEach(n,i);else if(e.length===e.length+0){for(var r=0,o=e.length;r<o;r++)if(r in e&&n.call(i,e[r],r)===this.BREAK)return}else for(var r in e)if(n.call(i,e[r],r)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),i.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(i.utils.common),i.dom.dom=function(t){function e(e){if("0"===e||t.isUndefined(e))return 0;var n=e.match(r);return t.isNull(n)?0:parseFloat(n[1])}var n={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},i={};t.each(n,function(e,n){t.each(e,function(t){i[t]=n})});var r=/(\d+(\.\d+)?)px/,o={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,n,i){t.isUndefined(n)&&(n=!0),t.isUndefined(i)&&(i=!0),e.style.position="absolute",n&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,n,r,o){r=r||{};var a=i[n];if(!a)throw new Error("Event type "+n+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var u=r.x||r.clientX||0,l=r.y||r.clientY||0;s.initMouseEvent(n,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,u,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=s.initKeyboardEvent||s.initKeyEvent;t.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(n,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:s.initEvent(n,r.bubbles||!1,r.cancelable||!0)}t.defaults(s,o),e.dispatchEvent(s)},bind:function(t,e,n,i){return i=i||!1,t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n),o},unbind:function(t,e,n,i){return i=i||!1,t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n),o},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1==n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(t,e){if(e)if(void 0===t.className);else if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),i=n.indexOf(e);-1!=i&&(n.splice(i,1),t.className=n.join(" "))}else t.className=void 0;return o},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var n=getComputedStyle(t);return e(n["border-left-width"])+e(n["border-right-width"])+e(n["padding-left"])+e(n["padding-right"])+e(n.width)},getHeight:function(t){var n=getComputedStyle(t);return e(n["border-top-width"])+e(n["border-bottom-width"])+e(n["padding-top"])+e(n["padding-bottom"])+e(n.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do{e.left+=t.offsetLeft,e.top+=t.offsetTop}while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return o}(i.utils.common),i.controllers.OptionController=function(t,e,n){var i=function(t,r,o){i.superclass.call(this,t,r);var a=this;if(this.__select=document.createElement("select"),n.isArray(o)){var s={};n.each(o,function(t){s[t]=t}),o=s}n.each(o,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),a.__select.appendChild(n)}),this.updateDisplay(),e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;a.setValue(t)}),this.domElement.appendChild(this.__select)};return i.superclass=t,n.extend(i.prototype,t.prototype,{setValue:function(t){var e=i.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),i.superclass.prototype.updateDisplay.call(this)}}),i}(i.controllers.Controller,i.dom.dom,i.utils.common),i.controllers.NumberController=function(t,e){function n(t){return t=t.toString(),t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var i=function(t,r,o){i.superclass.call(this,t,r),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,e.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=n(this.__impliedStep)};return i.superclass=t,e.extend(i.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&t%this.__step!=0&&(t=Math.round(t/this.__step)*this.__step),i.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__step=t,this}}),i}(i.controllers.Controller,i.utils.common),i.controllers.NumberControllerBox=function(t,e,n){function i(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var r=function(t,i,o){function a(){var t=parseFloat(h.__input.value);n.isNaN(t)||h.setValue(t)}function s(){a(),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function u(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),d=t.clientY}function l(t){var e=d-t.clientY;h.setValue(h.getValue()+e*h.__impliedStep),d=t.clientY}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c)}this.__truncationSuspended=!1,r.superclass.call(this,t,i,o);var d,h=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",a),e.bind(this.__input,"blur",s),e.bind(this.__input,"mousedown",u),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=t,n.extend(r.prototype,t.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():i(this.getValue(),this.__precision),r.superclass.prototype.updateDisplay.call(this)}}),r}(i.controllers.NumberController,i.dom.dom,i.utils.common),i.controllers.NumberControllerSlider=function(t,e,n,i,r){function o(t,e,n,i,r){return i+(t-e)/(n-e)*(r-i)}var a=function(t,n,i,r,s){function u(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),l(t)}function l(t){t.preventDefault();var n=e.getOffset(d.__background),i=e.getWidth(d.__background);return d.setValue(o(t.clientX,n.left,n.left+i,d.__min,d.__max)),!1}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}a.superclass.call(this,t,n,{min:i,max:r,step:s});var d=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",u),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return a.superclass=t,a.useDefaultStyles=function(){n.inject(".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}")},i.extend(a.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",a.superclass.prototype.updateDisplay.call(this)}}),a}(i.controllers.NumberController,i.dom.dom,i.utils.css,i.utils.common),i.controllers.FunctionController=function(t,e,n){var i=function(t,n,r){i.superclass.call(this,t,n);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===r?"Fire":r,e.bind(this.__button,"click",function(t){return t.preventDefault(),o.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return i.superclass=t,n.extend(i.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),i}(i.controllers.Controller,i.dom.dom,i.utils.common),i.controllers.BooleanController=function(t,e,n){var i=function(t,n){function r(){o.setValue(!o.__prev)}i.superclass.call(this,t,n);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",r,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return i.superclass=t,n.extend(i.prototype,t.prototype,{setValue:function(t){var e=i.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,i.superclass.prototype.updateDisplay.call(this)}}),i}(i.controllers.Controller,i.dom.dom,i.utils.common),i.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(i.utils.common),i.color.interpret=function(t,e){var n,i,r=function(){i=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(r){if(r.litmus(t))return e.each(r.conversions,function(r,o){if(n=r.read(t),!1===i&&!1!==n)return i=n,n.conversionName=o,n.conversion=r,e.BREAK}),e.BREAK}),i},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return r}(i.color.toString,i.utils.common),i.GUI=i.gui.GUI=function(t,e,n,i,r,o,a,s,u,l,c,d,h,p,f){function m(t,e,n,o){if(void 0===e[n])throw new Error("Object "+e+' has no property "'+n+'"');var a;if(o.color)a=new c(e,n);else{var s=[e,n].concat(o.factoryArgs);a=i.apply(t,s)}o.before instanceof r&&(o.before=o.before.__li),_(t,a),p.addClass(a.domElement,"c");var u=document.createElement("span");p.addClass(u,"property-name"),u.innerHTML=a.property;var l=document.createElement("div");l.appendChild(u),l.appendChild(a.domElement);var d=v(t,l,o.before);return p.addClass(d,D.CLASS_CONTROLLER_ROW),p.addClass(d,typeof a.getValue()),g(t,d,a),t.__controllers.push(a),a}function v(t,e,n){var i=document.createElement("li");return e&&i.appendChild(e),n?t.__ul.insertBefore(i,params.before):t.__ul.appendChild(i),t.onResize(),i}function g(t,e,n){if(n.__li=e,n.__gui=t,f.extend(n,{options:function(e){return arguments.length>1?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[f.toArray(arguments)]})):f.isArray(e)||f.isObject(e)?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof u){var i=new s(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});f.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=n[t],r=i[t];n[t]=i[t]=function(){var t=Array.prototype.slice.call(arguments);return e.apply(n,t),r.apply(i,t)}}),p.addClass(e,"has-slider"),n.domElement.insertBefore(i.domElement,n.domElement.firstElementChild)}else if(n instanceof s){var r=function(e){return f.isNumber(n.__min)&&f.isNumber(n.__max)?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):e};n.min=f.compose(r,n.min),n.max=f.compose(r,n.max)}else n instanceof o?(p.bind(e,"click",function(){p.fakeEvent(n.__checkbox,"click")}),p.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof a?(p.bind(e,"click",function(){p.fakeEvent(n.__button,"click")}),p.bind(e,"mouseover",function(){p.addClass(n.__button,"hover")}),p.bind(e,"mouseout",function(){p.removeClass(n.__button,"hover")})):n instanceof c&&(p.addClass(e,"color"),n.updateDisplay=f.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=f.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&A(t.getRoot(),!0),e},n.setValue)}function _(t,e){var n=t.getRoot(),i=n.__rememberedObjects.indexOf(e.object);if(-1!=i){var r=n.__rememberedObjectIndecesToControllers[i];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[i]=r),r[e.property]=e,n.load&&n.load.remembered){var o,a=n.load.remembered;if(a[t.preset])o=a[t.preset];else{if(!a[T])return;o=a[T]}if(o[i]&&void 0!==o[i][e.property]){var s=o[i][e.property];e.initialValue=s,e.setValue(s)}}}}function b(t,e){return document.location.href+"."+e}function y(t){function e(){l.style.display=t.useLocalStorage?"block":"none"}var n=t.__save_row=document.createElement("li");p.addClass(t.domElement,"has-save"),t.__ul.insertBefore(n,t.__ul.firstChild),p.addClass(n,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;",p.addClass(i,"button gears");var r=document.createElement("span");r.innerHTML="Save",p.addClass(r,"button"),p.addClass(r,"save");var o=document.createElement("span");o.innerHTML="New",p.addClass(o,"button"),p.addClass(o,"save-as");var a=document.createElement("span");a.innerHTML="Revert",p.addClass(a,"button"),p.addClass(a,"revert");var s=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?f.each(t.load.remembered,function(e,n){E(t,n,n==t.preset)}):E(t,T,!1),p.bind(s,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),n.appendChild(s),n.appendChild(i),n.appendChild(r),n.appendChild(o),n.appendChild(a),C){var u=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");u.style.display="block";var c=document.getElementById("dg-local-storage");"true"===localStorage.getItem(b(t,"isLocal"))&&c.setAttribute("checked","checked"),e(),p.bind(c,"change",function(){t.useLocalStorage=!t.useLocalStorage,e()})}var d=document.getElementById("dg-new-constructor");p.bind(d,"keydown",function(t){!t.metaKey||67!==t.which&&67!=t.keyCode||P.hide()}),p.bind(i,"click",function(){d.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),P.show(),d.focus(),d.select()}),p.bind(r,"click",function(){t.save()}),p.bind(o,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),p.bind(a,"click",function(){t.revert()})}function x(t){function e(e){return e.preventDefault(),r=e.clientX,p.addClass(t.__closeButton,D.CLASS_DRAG),p.bind(window,"mousemove",n),p.bind(window,"mouseup",i),!1}function n(e){return e.preventDefault(),t.width+=r-e.clientX,t.onResize(),r=e.clientX,!1}function i(){p.removeClass(t.__closeButton,D.CLASS_DRAG),p.unbind(window,"mousemove",n),p.unbind(window,"mouseup",i)}t.__resize_handle=document.createElement("div"),f.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var r;p.bind(t.__resize_handle,"mousedown",e),p.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function w(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function M(t,e){var n={};return f.each(t.__rememberedObjects,function(i,r){var o={},a=t.__rememberedObjectIndecesToControllers[r];f.each(a,function(t,n){o[n]=e?t.initialValue:t.getValue()}),n[r]=o}),n}function E(t,e,n){var i=document.createElement("option");i.innerHTML=e,i.value=e,t.__preset_select.appendChild(i),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function S(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value==t.preset&&(t.__preset_select.selectedIndex=e)}function A(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function R(t){0!=t.length&&d(function(){R(t)}),f.each(t,function(t){t.updateDisplay()})}
t.inject(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");var P,O,T="Default",C=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),N=!0,I=!1,L=[],D=function(t){function e(){localStorage.setItem(b(n,"gui"),JSON.stringify(n.getSaveObject()))}var n=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),p.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=f.defaults(t,{autoPlace:!0,width:D.DEFAULT_WIDTH}),t=f.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),f.isUndefined(t.load)?t.load={preset:T}:t.preset&&(t.load.preset=t.preset),f.isUndefined(t.parent)&&t.hideable&&L.push(this),t.resizable=f.isUndefined(t.parent)&&t.resizable,t.autoPlace&&f.isUndefined(t.scrollable)&&(t.scrollable=!0);var i=C&&"true"===localStorage.getItem(b(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return n.parent?n.getRoot().preset:t.load.preset},set:function(e){n.parent?n.getRoot().preset=e:t.load.preset=e,S(this),n.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,w(n,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,o&&(o.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?p.addClass(n.__ul,D.CLASS_CLOSED):p.removeClass(n.__ul,D.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?D.TEXT_OPEN:D.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return i},set:function(t){C&&(i=t,t?p.bind(window,"unload",e):p.unbind(window,"unload",e),localStorage.setItem(b(n,"isLocal"),t))}}}),f.isUndefined(t.parent)){if(t.closed=!1,p.addClass(this.domElement,D.CLASS_MAIN),p.makeSelectable(this.domElement,!1),C&&i){n.useLocalStorage=!0;var r=localStorage.getItem(b(this,"gui"));r&&(t.load=JSON.parse(r))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=D.TEXT_CLOSED,p.addClass(this.__closeButton,D.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),p.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===t.closed&&(t.closed=!0);var o=document.createTextNode(t.name);p.addClass(o,"controller-name");var a=v(n,o),s=function(t){return t.preventDefault(),n.closed=!n.closed,!1};p.addClass(this.__ul,D.CLASS_CLOSED),p.addClass(a,"title"),p.bind(a,"click",s),t.closed||(this.closed=!1)}t.autoPlace&&(f.isUndefined(t.parent)&&(N&&(O=document.createElement("div"),p.addClass(O,"dg"),p.addClass(O,D.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(O),N=!1),O.appendChild(this.domElement),p.addClass(this.domElement,D.CLASS_AUTO_PLACE)),this.parent||w(n,t.width)),p.bind(window,"resize",function(){n.onResize()}),p.bind(this.__ul,"webkitTransitionEnd",function(){n.onResize()}),p.bind(this.__ul,"transitionend",function(){n.onResize()}),p.bind(this.__ul,"oTransitionEnd",function(){n.onResize()}),this.onResize(),t.resizable&&x(this);n.getRoot();t.parent||function(){var t=n.getRoot();t.width+=1,f.defer(function(){t.width-=1})}()};return D.toggleHide=function(){I=!I,f.each(L,function(t){t.domElement.style.zIndex=I?-999:999,t.domElement.style.opacity=I?0:1})},D.CLASS_AUTO_PLACE="a",D.CLASS_AUTO_PLACE_CONTAINER="ac",D.CLASS_MAIN="main",D.CLASS_CONTROLLER_ROW="cr",D.CLASS_TOO_TALL="taller-than-window",D.CLASS_CLOSED="closed",D.CLASS_CLOSE_BUTTON="close-button",D.CLASS_DRAG="drag",D.DEFAULT_WIDTH=245,D.TEXT_CLOSED="Close Controls",D.TEXT_OPEN="Open Controls",p.bind(window,"keydown",function(t){"text"===document.activeElement.type||72!==t.which&&72!=t.keyCode||D.toggleHide()},!1),f.extend(D.prototype,{add:function(t,e){return m(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return m(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.slice(this.__controllers.indexOf(t),1);var e=this;f.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&O.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new D(e);this.__folders[t]=n;var i=v(this,n.domElement);return p.addClass(i,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=p.getOffset(t.__ul).top,n=0;f.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=p.getHeight(e))}),window.innerHeight-e-20<n?(p.addClass(t.domElement,D.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(p.removeClass(t.domElement,D.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&f.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(f.isUndefined(P)&&(P=new h,P.domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;f.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&y(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=M(this)),t.folders={},f.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=M(this),A(this,!1)},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[T]=M(this,!0)),this.load.remembered[t]=M(this),this.preset=t,E(this,t,!0)},revert:function(t){f.each(this.__controllers,function(e){this.getRoot().load.remembered?_(t||this.getRoot(),e):e.setValue(e.initialValue)},this),f.each(this.__folders,function(t){t.revert(t)}),t||A(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&R(this.__listening)}}),D}(i.utils.css,0,0,i.controllers.factory=function(t,e,n,i,r,o,a){return function(s,u){var l=s[u];return a.isArray(arguments[2])||a.isObject(arguments[2])?new t(s,u,arguments[2]):a.isNumber(l)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new n(s,u,arguments[2],arguments[3]):new e(s,u,{min:arguments[2],max:arguments[3]}):a.isString(l)?new i(s,u):a.isFunction(l)?new r(s,u,""):a.isBoolean(l)?new o(s,u):void 0}}(i.controllers.OptionController,i.controllers.NumberControllerBox,i.controllers.NumberControllerSlider,i.controllers.StringController=function(t,e,n){var i=function(t,n){function r(){a.setValue(a.__input.value)}function o(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}i.superclass.call(this,t,n);var a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",r),e.bind(this.__input,"change",r),e.bind(this.__input,"blur",o),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=t,n.extend(i.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),i.superclass.prototype.updateDisplay.call(this)}}),i}(i.controllers.Controller,i.dom.dom,i.utils.common),i.controllers.FunctionController,i.controllers.BooleanController,i.utils.common),i.controllers.Controller,i.controllers.BooleanController,i.controllers.FunctionController,i.controllers.NumberControllerBox,i.controllers.NumberControllerSlider,i.controllers.OptionController,i.controllers.ColorController=function(t,e,n,i,r){function o(t,e,n,i){t.style.background="",r.each(u,function(r){t.style.cssText+="background: "+r+"linear-gradient("+e+", "+n+" 0%, "+i+" 100%); "})}function a(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(t,u){function l(t){p(t),e.bind(window,"mousemove",p),e.bind(window,"mouseup",c)}function c(){e.unbind(window,"mousemove",p),e.unbind(window,"mouseup",c)}function d(){var t=i(this.value);!1!==t?(m.__color.__state=t,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function h(){e.unbind(window,"mousemove",f),e.unbind(window,"mouseup",h)}function p(t){t.preventDefault();var n=e.getWidth(m.__saturation_field),i=e.getOffset(m.__saturation_field),r=(t.clientX-i.left+document.body.scrollLeft)/n,o=1-(t.clientY-i.top+document.body.scrollTop)/n;return o>1?o=1:o<0&&(o=0),r>1?r=1:r<0&&(r=0),m.__color.v=o,m.__color.s=r,m.setValue(m.__color.toOriginal()),!1}function f(t){t.preventDefault();var n=e.getHeight(m.__hue_field),i=e.getOffset(m.__hue_field),r=1-(t.clientY-i.top+document.body.scrollTop)/n;return r>1?r=1:r<0&&(r=0),m.__color.h=360*r,m.setValue(m.__color.toOriginal()),!1}s.superclass.call(this,t,u),this.__color=new n(this.getValue()),this.__temp=new n(0);var m=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&d.call(this)}),e.bind(this.__input,"blur",d),e.bind(this.__selector,"mousedown",function(t){e.addClass(this,"drag").bind(window,"mouseup",function(t){e.removeClass(m.__selector,"drag")})});var v=document.createElement("div");r.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),r.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),r.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),r.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),r.extend(v.style,{width:"100%",height:"100%",background:"none"}),o(v,"top","rgba(0,0,0,0)","#000"),r.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),a(this.__hue_field),r.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",l),e.bind(this.__field_knob,"mousedown",l),e.bind(this.__hue_field,"mousedown",function(t){f(t),e.bind(window,"mousemove",f),e.bind(window,"mouseup",h)}),this.__saturation_field.appendChild(v),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};s.superclass=t,r.extend(s.prototype,t.prototype,{updateDisplay:function(){var t=i(this.getValue());if(!1!==t){var e=!1;r.each(n.COMPONENTS,function(n){if(!r.isUndefined(t[n])&&!r.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&r.extend(this.__color.__state,t)}r.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;r.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),r.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var u=["-moz-","-o-","-webkit-","-ms-",""];return s}(i.controllers.Controller,i.dom.dom,i.color.Color=function(t,e,n,i){function r(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(a(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(a(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(s(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[e]=t}})}function a(t,n,r){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,r);else{if("HSV"!==t.__state.space)throw"Corrupted color state";i.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function s(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);i.extend(t.__state,{s:n.s,v:n.v}),i.isNaN(n.h)?i.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var u=function(){if(this.__state=t.apply(this,arguments),!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],i.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),r(u.prototype,"r",2),r(u.prototype,"g",1),r(u.prototype,"b",0),o(u.prototype,"h"),o(u.prototype,"s"),o(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),u}(i.color.interpret,i.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var i=Math.floor(t/60)%6,r=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-r*e),s=n*(1-(1-r)*e),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][i];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var i,r,o=Math.min(t,e,n),a=Math.max(t,e,n),s=a-o;return 0==a?{h:NaN,s:0,v:0}:(r=s/a,i=t==a?(e-n)/s:e==a?2+(n-t)/s:4+(t-e)/s,i/=6,i<0&&(i+=1),{h:360*i,s:r,v:a/255})},rgb_to_hex:function(t,e,n){var i=this.hex_with_component(0,2,t);return i=this.hex_with_component(i,1,e),i=this.hex_with_component(i,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,i){return i<<(t=8*n)|e&~(255<<t)}}}(),i.color.toString,i.utils.common),i.color.interpret,i.utils.common),i.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),i.dom.CenteredDiv=function(t,e){var n=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;t.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var e=this,n=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",n),t.unbind(e.domElement,"transitionend",n),t.unbind(e.domElement,"oTransitionEnd",n)};t.bind(this.domElement,"webkitTransitionEnd",n),t.bind(this.domElement,"transitionend",n),t.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},n}(i.dom.dom,i.utils.common),i.dom.dom,i.utils.common)},{}],4:[function(t,e,n){function i(t,e,n){var i=l[e];if(void 0===i&&(i=o(e)),i){if(void 0===n)return t.style[i];"number"==typeof n&&(n+=c[i]||""),t.style[i]=n}}function r(t,e){for(var n in e)e.hasOwnProperty(n)&&i(t,n,e[n])}function o(t){var e=u(t),n=s(e);return l[e]=l[t]=l[n]=n,n}function a(){2===arguments.length?r(arguments[0],arguments[1]):i(arguments[0],arguments[1],arguments[2])}var s=t(29),u=t(34),l={float:"cssFloat"},c={};["top","right","bottom","left","width","height","fontSize","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","padding","margin","perspective"].forEach(function(t){c[t]="px"}),e.exports=a,e.exports.set=a,e.exports.get=function(t,e){return Array.isArray(e)?e.reduce(function(e,n){return e[n]=i(t,n||""),e},{}):i(t,e||"")}},{29:29,34:34}],5:[function(t,e,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function o(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},i.prototype.emit=function(t){var e,n,i,o,u,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(n=this._events[t],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(a(n))for(o=Array.prototype.slice.call(arguments,1),l=n.slice(),i=l.length,u=0;u<i;u++)l[u].apply(this,o);return!0},i.prototype.addListener=function(t,e){var n;if(!r(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,a(this._events[t])&&!this._events[t].warned&&(n=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},i.prototype.removeListener=function(t,e){var n,i,o,s;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,i=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(a(n)){for(s=o;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},i.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},i.prototype.listeners=function(t){return this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},i.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(r(e))return 1;if(e)return e.length}return 0},i.listenerCount=function(t,e){return t.listenerCount(e)}},{}],6:[function(t,e,n){!function(t,i){if("object"==typeof n&&"object"==typeof e)e.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var r=i();for(var o in r)("object"==typeof n?n:t)[o]=r[o]}}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,n){"use strict";function i(t){e.ARRAY_TYPE=s=t}function r(t){return t*u}function o(t,e){return Math.abs(t-e)<=a*Math.max(1,Math.abs(t),Math.abs(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=i,e.toRadian=r,e.equals=o;var a=e.EPSILON=1e-6,s=e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,u=(e.RANDOM=Math.random,Math.PI/180)},function(t,e,n){"use strict";function i(){var t=new L.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function r(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function o(t){var e=new L.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function s(t,e,n,i,r,o,a,s,u){var l=new L.ARRAY_TYPE(9);return l[0]=t,l[1]=e,l[2]=n,l[3]=i,l[4]=r,l[5]=o,l[6]=a,l[7]=s,l[8]=u,l}function u(t,e,n,i,r,o,a,s,u,l){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t}function l(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function c(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function d(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],d=c*a-s*l,h=-c*o+s*u,p=l*o-a*u,f=n*d+i*h+r*p;return f?(f=1/f,t[0]=d*f,t[1]=(-c*i+r*l)*f,t[2]=(s*i-r*a)*f,t[3]=h*f,t[4]=(c*n-r*u)*f,t[5]=(-s*n+r*o)*f,t[6]=p*f,t[7]=(-l*n+i*u)*f,t[8]=(a*n-i*o)*f,t):null}function h(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8];return t[0]=a*c-s*l,t[1]=r*l-i*c,t[2]=i*s-r*a,t[3]=s*u-o*c,t[4]=n*c-r*u,t[5]=r*o-n*s,t[6]=o*l-a*u,t[7]=i*u-n*l,t[8]=n*a-i*o,t}function p(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-a*u)+n*(-l*r+a*s)+i*(u*r-o*s)}function f(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=n[0],p=n[1],f=n[2],m=n[3],v=n[4],g=n[5],_=n[6],b=n[7],y=n[8];return t[0]=h*i+p*a+f*l,t[1]=h*r+p*s+f*c,t[2]=h*o+p*u+f*d,t[3]=m*i+v*a+g*l,t[4]=m*r+v*s+g*c,t[5]=m*o+v*u+g*d,t[6]=_*i+b*a+y*l,t[7]=_*r+b*s+y*c,t[8]=_*o+b*u+y*d,t}function m(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=n[0],p=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h*i+p*a+l,t[7]=h*r+p*s+c,t[8]=h*o+p*u+d,t}function v(t,e,n){
var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=Math.sin(n),p=Math.cos(n);return t[0]=p*i+h*a,t[1]=p*r+h*s,t[2]=p*o+h*u,t[3]=p*a-h*i,t[4]=p*s-h*r,t[5]=p*u-h*o,t[6]=l,t[7]=c,t[8]=d,t}function g(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function _(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function b(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function y(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function x(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function w(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,u=r+r,l=n*a,c=i*a,d=i*s,h=r*a,p=r*s,f=r*u,m=o*a,v=o*s,g=o*u;return t[0]=1-d-f,t[3]=c-g,t[6]=h+v,t[1]=c+g,t[4]=1-l-f,t[7]=p-m,t[2]=h-v,t[5]=p+m,t[8]=1-l-d,t}function M(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],d=e[9],h=e[10],p=e[11],f=e[12],m=e[13],v=e[14],g=e[15],_=n*s-i*a,b=n*u-r*a,y=n*l-o*a,x=i*u-r*s,w=i*l-o*s,M=r*l-o*u,E=c*m-d*f,S=c*v-h*f,A=c*g-p*f,R=d*v-h*m,P=d*g-p*m,O=h*g-p*v,T=_*O-b*P+y*R+x*A-w*S+M*E;return T?(T=1/T,t[0]=(s*O-u*P+l*R)*T,t[1]=(u*A-a*O-l*S)*T,t[2]=(a*P-s*A+l*E)*T,t[3]=(r*P-i*O-o*R)*T,t[4]=(n*O-r*A+o*S)*T,t[5]=(i*A-n*P-o*E)*T,t[6]=(m*M-v*w+g*x)*T,t[7]=(v*y-f*M-g*b)*T,t[8]=(f*w-m*y+g*_)*T,t):null}function E(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function S(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function A(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function R(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function P(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function O(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function T(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t}function C(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function N(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],d=e[0],h=e[1],p=e[2],f=e[3],m=e[4],v=e[5],g=e[6],_=e[7],b=e[8];return Math.abs(n-d)<=L.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(i-h)<=L.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-p)<=L.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(o-f)<=L.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-m)<=L.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-v)<=L.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-g)<=L.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(l-_)<=L.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(c-b)<=L.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=i,e.fromMat4=r,e.clone=o,e.copy=a,e.fromValues=s,e.set=u,e.identity=l,e.transpose=c,e.invert=d,e.adjoint=h,e.determinant=p,e.multiply=f,e.translate=m,e.rotate=v,e.scale=g,e.fromTranslation=_,e.fromRotation=b,e.fromScaling=y,e.fromMat2d=x,e.fromQuat=w,e.normalFromMat4=M,e.projection=E,e.str=S,e.frob=A,e.add=R,e.subtract=P,e.multiplyScalar=O,e.multiplyScalarAndAdd=T,e.exactEquals=C,e.equals=N;var I=n(0),L=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(I);e.mul=f,e.sub=P},function(t,e,n){"use strict";function i(){var t=new U.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function r(t){var e=new U.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function o(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}function a(t,e,n){var i=new U.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function u(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}function l(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function c(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function d(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function h(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function p(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function f(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function m(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function v(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function _(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function b(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}function y(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)}function x(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}function w(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function M(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function E(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function S(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function A(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function R(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=r*u-o*s,t[1]=o*a-i*u,t[2]=i*s-r*a,t}function P(t,e,n,i){var r=e[0],o=e[1],a=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t}function O(t,e,n,i,r,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,l=a*(o-1),c=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+i[0]*l+r[0]*c,t[1]=e[1]*s+n[1]*u+i[1]*l+r[1]*c,t[2]=e[2]*s+n[2]*u+i[2]*l+r[2]*c,t}function T(t,e,n,i,r,o){var a=1-o,s=a*a,u=o*o,l=s*a,c=3*o*s,d=3*u*a,h=u*o;return t[0]=e[0]*l+n[0]*c+i[0]*d+r[0]*h,t[1]=e[1]*l+n[1]*c+i[1]*d+r[1]*h,t[2]=e[2]*l+n[2]*c+i[2]*d+r[2]*h,t}function C(t,e){e=e||1;var n=2*U.RANDOM()*Math.PI,i=2*U.RANDOM()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}function N(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[3]*i+n[7]*r+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/a,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/a,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/a,t}function I(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function L(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*i+s*o-u*r,d=l*r+u*i-a*o,h=l*o+a*r-s*i,p=-a*i-s*r-u*o;return t[0]=c*l+p*-a+d*-u-h*-s,t[1]=d*l+p*-s+h*-a-c*-u,t[2]=h*l+p*-u+c*-s-d*-a,t}function D(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function F(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function k(t,e,n,i){var r=[],o=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function B(t,e){var n=a(t[0],t[1],t[2]),i=a(e[0],e[1],e[2]);S(n,n),S(i,i);var r=A(n,i);return r>1?0:r<-1?Math.PI:Math.acos(r)}function V(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function z(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function j(t,e){var n=t[0],i=t[1],r=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=U.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=U.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-s)<=U.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=i,e.clone=r,e.length=o,e.fromValues=a,e.copy=s,e.set=u,e.add=l,e.subtract=c,e.multiply=d,e.divide=h,e.ceil=p,e.floor=f,e.min=m,e.max=v,e.round=g,e.scale=_,e.scaleAndAdd=b,e.distance=y,e.squaredDistance=x,e.squaredLength=w,e.negate=M,e.inverse=E,e.normalize=S,e.dot=A,e.cross=R,e.lerp=P,e.hermite=O,e.bezier=T,e.random=C,e.transformMat4=N,e.transformMat3=I,e.transformQuat=L,e.rotateX=D,e.rotateY=F,e.rotateZ=k,e.angle=B,e.str=V,e.exactEquals=z,e.equals=j;var H=n(0),U=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(H);e.sub=c,e.mul=d,e.div=h,e.dist=y,e.sqrDist=x,e.len=o,e.sqrLen=w,e.forEach=function(){var t=i();return function(e,n,i,r,o,a){var s=void 0,u=void 0;for(n||(n=3),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,s=i;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}()},function(t,e,n){"use strict";function i(){var t=new D.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function r(t){var e=new D.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o(t,e,n,i){var r=new D.ARRAY_TYPE(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function s(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function l(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function c(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function d(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function h(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function p(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function f(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function m(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function v(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function g(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function _(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t}function b(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+i*i+r*r+o*o)}function y(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+i*i+r*r+o*o}function x(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)}function w(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function M(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function E(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function S(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=o*a),t}function A(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function R(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t[3]=s+i*(n[3]-s),t}function P(t,e){return e=e||1,t[0]=D.RANDOM(),t[1]=D.RANDOM(),t[2]=D.RANDOM(),t[3]=D.RANDOM(),S(t,t),g(t,t,e),t}function O(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}function T(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*i+s*o-u*r,d=l*r+u*i-a*o,h=l*o+a*r-s*i,p=-a*i-s*r-u*o;return t[0]=c*l+p*-a+d*-u-h*-s,t[1]=d*l+p*-s+h*-a-c*-u,t[2]=h*l+p*-u+c*-s-d*-a,t[3]=e[3],t}function C(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function N(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function I(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=e[0],s=e[1],u=e[2],l=e[3];return Math.abs(n-a)<=D.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=D.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-u)<=D.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-l)<=D.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=i,e.clone=r,e.fromValues=o,e.copy=a,e.set=s,e.add=u,e.subtract=l,e.multiply=c,e.divide=d,e.ceil=h,e.floor=p,e.min=f,e.max=m,e.round=v,e.scale=g,e.scaleAndAdd=_,e.distance=b,e.squaredDistance=y,e.length=x,e.squaredLength=w,e.negate=M,e.inverse=E,e.normalize=S,e.dot=A,e.lerp=R,e.random=P,e.transformMat4=O,e.transformQuat=T,e.str=C,e.exactEquals=N,e.equals=I;var L=n(0),D=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(L);e.sub=l,e.mul=c,e.div=d,e.dist=b,e.sqrDist=y,e.len=x,e.sqrLen=w,e.forEach=function(){var t=i();return function(e,n,i,r,o,a){var s=void 0,u=void 0;for(n||(n=4),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,s=i;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}()},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var r=n(0),o=i(r),a=n(5),s=i(a),u=n(6),l=i(u),c=n(1),d=i(c),h=n(7),p=i(h),f=n(8),m=i(f),v=n(9),g=i(v),_=n(2),b=i(_),y=n(3),x=i(y);e.glMatrix=o,e.mat2=s,e.mat2d=l,e.mat3=d,e.mat4=p,e.quat=m,e.vec2=g,e.vec3=b,e.vec4=x},function(t,e,n){"use strict";function i(){var t=new P.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function r(t){var e=new P.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function s(t,e,n,i){var r=new P.ARRAY_TYPE(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}function u(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function l(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function c(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*o-r*i;return a?(a=1/a,t[0]=o*a,t[1]=-i*a,t[2]=-r*a,t[3]=n*a,t):null}function d(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function h(t){return t[0]*t[3]-t[2]*t[1]}function p(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=i*s+o*u,t[1]=r*s+a*u,t[2]=i*l+o*c,t[3]=r*l+a*c,t}function f(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+o*s,t[1]=r*u+a*s,t[2]=i*-s+o*u,t[3]=r*-s+a*u,t}function m(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=i*s,t[1]=r*s,t[2]=o*u,t[3]=a*u,t}function v(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t}function g(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function _(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function b(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function y(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]}function x(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function w(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function M(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function E(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=e[0],s=e[1],u=e[2],l=e[3];return Math.abs(n-a)<=P.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=P.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(r-u)<=P.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-l)<=P.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))}function S(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function A(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=i,e.clone=r,e.copy=o,e.identity=a,e.fromValues=s,e.set=u,e.transpose=l,e.invert=c,e.adjoint=d,e.determinant=h,e.multiply=p,e.rotate=f,e.scale=m,e.fromRotation=v,e.fromScaling=g,e.str=_,e.frob=b,e.LDU=y,e.add=x,e.subtract=w,e.exactEquals=M,e.equals=E,e.multiplyScalar=S,e.multiplyScalarAndAdd=A;var R=n(0),P=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(R);e.mul=p,e.sub=w},function(t,e,n){"use strict";function i(){var t=new R.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function r(t){var e=new R.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function s(t,e,n,i,r,o){var a=new R.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a[4]=r,a[5]=o,a}function u(t,e,n,i,r,o,a){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t}function l(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=n*o-i*r;return u?(u=1/u,t[0]=o*u,t[1]=-i*u,t[2]=-r*u,t[3]=n*u,t[4]=(r*s-o*a)*u,t[5]=(i*a-n*s)*u,t):null}function c(t){return t[0]*t[3]-t[1]*t[2]}function d(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1],d=n[2],h=n[3],p=n[4],f=n[5];return t[0]=i*l+o*c,t[1]=r*l+a*c,t[2]=i*d+o*h,t[3]=r*d+a*h,t[4]=i*p+o*f+s,t[5]=r*p+a*f+u,t}function h(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=i*c+o*l,t[1]=r*c+a*l,t[2]=i*-l+o*c,t[3]=r*-l+a*c,t[4]=s,t[5]=u,t}function p(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=i*l,t[1]=r*l,t[2]=o*c,t[3]=a*c,t[4]=s,t[5]=u,t}function f(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=i*l+o*c+s,t[5]=r*l+a*c+u,t}function m(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0,t}function v(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function g(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function _(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function b(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function y(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function x(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function w(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function M(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t}function E(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function S(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=e[0],l=e[1],c=e[2],d=e[3],h=e[4],p=e[5];return Math.abs(n-u)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-l)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(r-c)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-d)<=R.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-h)<=R.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-p)<=R.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=i,e.clone=r,e.copy=o,e.identity=a,e.fromValues=s,e.set=u,e.invert=l,e.determinant=c,e.multiply=d,e.rotate=h,e.scale=p,e.translate=f,e.fromRotation=m,e.fromScaling=v,e.fromTranslation=g,e.str=_,e.frob=b,e.add=y,e.subtract=x,e.multiplyScalar=w,e.multiplyScalarAndAdd=M,e.exactEquals=E,e.equals=S;var A=n(0),R=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(A);e.mul=d,e.sub=x},function(t,e,n){"use strict";function i(){var t=new X.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r(t){var e=new X.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function a(t,e,n,i,r,o,a,s,u,l,c,d,h,p,f,m){var v=new X.ARRAY_TYPE(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=i,v[4]=r,v[5]=o,v[6]=a,v[7]=s,v[8]=u,v[9]=l,v[10]=c,v[11]=d,v[12]=h,v[13]=p,v[14]=f,v[15]=m,v}function s(t,e,n,i,r,o,a,s,u,l,c,d,h,p,f,m,v){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t[9]=c,t[10]=d,t[11]=h,t[12]=p,t[13]=f,t[14]=m,t[15]=v,t}function u(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function l(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function c(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],d=e[9],h=e[10],p=e[11],f=e[12],m=e[13],v=e[14],g=e[15],_=n*s-i*a,b=n*u-r*a,y=n*l-o*a,x=i*u-r*s,w=i*l-o*s,M=r*l-o*u,E=c*m-d*f,S=c*v-h*f,A=c*g-p*f,R=d*v-h*m,P=d*g-p*m,O=h*g-p*v,T=_*O-b*P+y*R+x*A-w*S+M*E;return T?(T=1/T,t[0]=(s*O-u*P+l*R)*T,t[1]=(r*P-i*O-o*R)*T,t[2]=(m*M-v*w+g*x)*T,t[3]=(h*w-d*M-p*x)*T,t[4]=(u*A-a*O-l*S)*T,t[5]=(n*O-r*A+o*S)*T,t[6]=(v*y-f*M-g*b)*T,t[7]=(c*M-h*y+p*b)*T,t[8]=(a*P-s*A+l*E)*T,t[9]=(i*A-n*P-o*E)*T,t[10]=(f*w-m*y+g*_)*T,t[11]=(d*y-c*w-p*_)*T,t[12]=(s*S-a*R-u*E)*T,t[13]=(n*R-i*S+r*E)*T,t[14]=(m*b-f*x-v*_)*T,t[15]=(c*x-d*b+h*_)*T,t):null}function d(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],d=e[9],h=e[10],p=e[11],f=e[12],m=e[13],v=e[14],g=e[15];return t[0]=s*(h*g-p*v)-d*(u*g-l*v)+m*(u*p-l*h),t[1]=-(i*(h*g-p*v)-d*(r*g-o*v)+m*(r*p-o*h)),t[2]=i*(u*g-l*v)-s*(r*g-o*v)+m*(r*l-o*u),t[3]=-(i*(u*p-l*h)-s*(r*p-o*h)+d*(r*l-o*u)),t[4]=-(a*(h*g-p*v)-c*(u*g-l*v)+f*(u*p-l*h)),t[5]=n*(h*g-p*v)-c*(r*g-o*v)+f*(r*p-o*h),t[6]=-(n*(u*g-l*v)-a*(r*g-o*v)+f*(r*l-o*u)),t[7]=n*(u*p-l*h)-a*(r*p-o*h)+c*(r*l-o*u),t[8]=a*(d*g-p*m)-c*(s*g-l*m)+f*(s*p-l*d),t[9]=-(n*(d*g-p*m)-c*(i*g-o*m)+f*(i*p-o*d)),t[10]=n*(s*g-l*m)-a*(i*g-o*m)+f*(i*l-o*s),t[11]=-(n*(s*p-l*d)-a*(i*p-o*d)+c*(i*l-o*s)),t[12]=-(a*(d*v-h*m)-c*(s*v-u*m)+f*(s*h-u*d)),t[13]=n*(d*v-h*m)-c*(i*v-r*m)+f*(i*h-r*d),t[14]=-(n*(s*v-u*m)-a*(i*v-r*m)+f*(i*u-r*s)),t[15]=n*(s*h-u*d)-a*(i*h-r*d)+c*(i*u-r*s),t}function h(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],d=t[10],h=t[11],p=t[12],f=t[13],m=t[14],v=t[15];return(e*a-n*o)*(d*v-h*m)-(e*s-i*o)*(c*v-h*f)+(e*u-r*o)*(c*m-d*f)+(n*s-i*a)*(l*v-h*p)-(n*u-r*a)*(l*m-d*p)+(i*u-r*s)*(l*f-c*p)}function p(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=e[9],p=e[10],f=e[11],m=e[12],v=e[13],g=e[14],_=e[15],b=n[0],y=n[1],x=n[2],w=n[3];return t[0]=b*i+y*s+x*d+w*m,t[1]=b*r+y*u+x*h+w*v,t[2]=b*o+y*l+x*p+w*g,t[3]=b*a+y*c+x*f+w*_,b=n[4],y=n[5],x=n[6],w=n[7],t[4]=b*i+y*s+x*d+w*m,t[5]=b*r+y*u+x*h+w*v,t[6]=b*o+y*l+x*p+w*g,t[7]=b*a+y*c+x*f+w*_,b=n[8],y=n[9],x=n[10],w=n[11],t[8]=b*i+y*s+x*d+w*m,t[9]=b*r+y*u+x*h+w*v,t[10]=b*o+y*l+x*p+w*g,t[11]=b*a+y*c+x*f+w*_,b=n[12],y=n[13],x=n[14],w=n[15],t[12]=b*i+y*s+x*d+w*m,t[13]=b*r+y*u+x*h+w*v,t[14]=b*o+y*l+x*p+w*g,t[15]=b*a+y*c+x*f+w*_,t}function f(t,e,n){var i=n[0],r=n[1],o=n[2],a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,p=void 0,f=void 0,m=void 0,v=void 0,g=void 0;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*o+e[12],t[13]=e[1]*i+e[5]*r+e[9]*o+e[13],t[14]=e[2]*i+e[6]*r+e[10]*o+e[14],t[15]=e[3]*i+e[7]*r+e[11]*o+e[15]):(a=e[0],s=e[1],u=e[2],l=e[3],c=e[4],d=e[5],h=e[6],p=e[7],f=e[8],m=e[9],v=e[10],g=e[11],t[0]=a,t[1]=s,t[2]=u,t[3]=l,t[4]=c,t[5]=d,t[6]=h,t[7]=p,t[8]=f,t[9]=m,t[10]=v,t[11]=g,t[12]=a*i+c*r+f*o+e[12],t[13]=s*i+d*r+m*o+e[13],t[14]=u*i+h*r+v*o+e[14],t[15]=l*i+p*r+g*o+e[15]),t}function m(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function v(t,e,n,i){var r=i[0],o=i[1],a=i[2],s=Math.sqrt(r*r+o*o+a*a),u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,p=void 0,f=void 0,m=void 0,v=void 0,g=void 0,_=void 0,b=void 0,y=void 0,x=void 0,w=void 0,M=void 0,E=void 0,S=void 0,A=void 0,R=void 0,P=void 0,O=void 0,T=void 0,C=void 0;return Math.abs(s)<X.EPSILON?null:(s=1/s,r*=s,o*=s,a*=s,u=Math.sin(n),l=Math.cos(n),c=1-l,d=e[0],h=e[1],p=e[2],f=e[3],m=e[4],v=e[5],g=e[6],_=e[7],b=e[8],y=e[9],x=e[10],w=e[11],M=r*r*c+l,E=o*r*c+a*u,S=a*r*c-o*u,A=r*o*c-a*u,R=o*o*c+l,P=a*o*c+r*u,O=r*a*c+o*u,T=o*a*c-r*u,C=a*a*c+l,t[0]=d*M+m*E+b*S,t[1]=h*M+v*E+y*S,t[2]=p*M+g*E+x*S,t[3]=f*M+_*E+w*S,t[4]=d*A+m*R+b*P,t[5]=h*A+v*R+y*P,t[6]=p*A+g*R+x*P,t[7]=f*A+_*R+w*P,t[8]=d*O+m*T+b*C,t[9]=h*O+v*T+y*C,t[10]=p*O+g*T+x*C,t[11]=f*O+_*T+w*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function g(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],d=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+l*i,t[5]=a*r+c*i,t[6]=s*r+d*i,t[7]=u*r+h*i,t[8]=l*r-o*i,t[9]=c*r-a*i,t[10]=d*r-s*i,t[11]=h*r-u*i,t}function _(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],c=e[9],d=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-l*i,t[1]=a*r-c*i,t[2]=s*r-d*i,t[3]=u*r-h*i,t[8]=o*i+l*r,t[9]=a*i+c*r,t[10]=s*i+d*r,t[11]=u*i+h*r,t}function b(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],c=e[5],d=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+l*i,t[1]=a*r+c*i,t[2]=s*r+d*i,t[3]=u*r+h*i,t[4]=l*r-o*i,t[5]=c*r-a*i,t[6]=d*r-s*i,t[7]=h*r-u*i,t}function y(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function x(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(t,e,n){var i=n[0],r=n[1],o=n[2],a=Math.sqrt(i*i+r*r+o*o),s=void 0,u=void 0,l=void 0;return Math.abs(a)<X.EPSILON?null:(a=1/a,i*=a,r*=a,o*=a,s=Math.sin(e),u=Math.cos(e),l=1-u,t[0]=i*i*l+u,t[1]=r*i*l+o*s,t[2]=o*i*l-r*s,t[3]=0,t[4]=i*r*l-o*s,t[5]=r*r*l+u,t[6]=o*r*l+i*s,t[7]=0,t[8]=i*o*l+r*s,t[9]=r*o*l-i*s,t[10]=o*o*l+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function M(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function E(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=i+i,u=r+r,l=o+o,c=i*s,d=i*u,h=i*l,p=r*u,f=r*l,m=o*l,v=a*s,g=a*u,_=a*l;return t[0]=1-(p+m),t[1]=d+_,t[2]=h-g,t[3]=0,t[4]=d-_,t[5]=1-(c+m),t[6]=f+v,t[7]=0,t[8]=h+g,t[9]=f-v,t[10]=1-(c+p),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function R(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function P(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],a=e[5],s=e[6],u=e[8],l=e[9],c=e[10];return t[0]=Math.sqrt(n*n+i*i+r*r),t[1]=Math.sqrt(o*o+a*a+s*s),t[2]=Math.sqrt(u*u+l*l+c*c),t}function O(t,e){var n=e[0]+e[5]+e[10],i=0;return n>0?(i=2*Math.sqrt(n+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i),t}function T(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3],u=r+r,l=o+o,c=a+a,d=r*u,h=r*l,p=r*c,f=o*l,m=o*c,v=a*c,g=s*u,_=s*l,b=s*c,y=i[0],x=i[1],w=i[2];return t[0]=(1-(f+v))*y,t[1]=(h+b)*y,t[2]=(p-_)*y,t[3]=0,t[4]=(h-b)*x,t[5]=(1-(d+v))*x,t[6]=(m+g)*x,t[7]=0,t[8]=(p+_)*w,t[9]=(m-g)*w,t[10]=(1-(d+f))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function C(t,e,n,i,r){var o=e[0],a=e[1],s=e[2],u=e[3],l=o+o,c=a+a,d=s+s,h=o*l,p=o*c,f=o*d,m=a*c,v=a*d,g=s*d,_=u*l,b=u*c,y=u*d,x=i[0],w=i[1],M=i[2],E=r[0],S=r[1],A=r[2];return t[0]=(1-(m+g))*x,t[1]=(p+y)*x,t[2]=(f-b)*x,t[3]=0,t[4]=(p-y)*w,t[5]=(1-(h+g))*w,t[6]=(v+_)*w,t[7]=0,t[8]=(f+b)*M,t[9]=(v-_)*M,t[10]=(1-(h+m))*M,t[11]=0,t[12]=n[0]+E-(t[0]*E+t[4]*S+t[8]*A),t[13]=n[1]+S-(t[1]*E+t[5]*S+t[9]*A),t[14]=n[2]+A-(t[2]*E+t[6]*S+t[10]*A),t[15]=1,t}function N(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,u=r+r,l=n*a,c=i*a,d=i*s,h=r*a,p=r*s,f=r*u,m=o*a,v=o*s,g=o*u;return t[0]=1-d-f,t[1]=c+g,t[2]=h-v,t[3]=0,t[4]=c-g,t[5]=1-l-f,t[6]=p+m,t[7]=0,t[8]=h+v,t[9]=p-m,t[10]=1-l-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,e,n,i,r,o,a){var s=1/(n-e),u=1/(r-i),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t}function L(t,e,n,i,r){var o=1/Math.tan(e/2),a=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t}function D(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(r+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(r-o)*l*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}function F(t,e,n,i,r,o,a){var s=1/(e-n),u=1/(i-r),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*u,t[14]=(a+o)*l,t[15]=1,t}function k(t,e,n,i){var r=void 0,o=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,p=void 0,f=e[0],m=e[1],v=e[2],g=i[0],_=i[1],b=i[2],y=n[0],x=n[1],w=n[2];return Math.abs(f-y)<X.EPSILON&&Math.abs(m-x)<X.EPSILON&&Math.abs(v-w)<X.EPSILON?mat4.identity(t):(c=f-y,d=m-x,h=v-w,p=1/Math.sqrt(c*c+d*d+h*h),c*=p,d*=p,h*=p,r=_*h-b*d,o=b*c-g*h,a=g*d-_*c,p=Math.sqrt(r*r+o*o+a*a),p?(p=1/p,r*=p,o*=p,a*=p):(r=0,o=0,a=0),s=d*a-h*o,u=h*r-c*a,l=c*o-d*r,p=Math.sqrt(s*s+u*u+l*l),p?(p=1/p,s*=p,u*=p,l*=p):(s=0,u=0,l=0),t[0]=r,t[1]=s,t[2]=c,t[3]=0,t[4]=o,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=l,t[10]=h,t[11]=0,t[12]=-(r*f+o*m+a*v),t[13]=-(s*f+u*m+l*v),t[14]=-(c*f+d*m+h*v),t[15]=1,t)}function B(t,e,n,i){
var r=e[0],o=e[1],a=e[2],s=i[0],u=i[1],l=i[2],c=r-n[0],d=o-n[1],h=a-n[2],p=c*c+d*d+h*h;p>0&&(p=1/Math.sqrt(p),c*=p,d*=p,h*=p);var f=u*h-l*d,m=l*c-s*h,v=s*d-u*c;return t[0]=f,t[1]=m,t[2]=v,t[3]=0,t[4]=d*v-h*m,t[5]=h*f-c*v,t[6]=c*m-d*f,t[7]=0,t[8]=c,t[9]=d,t[10]=h,t[11]=0,t[12]=r,t[13]=o,t[14]=a,t[15]=1,t}function V(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function z(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function j(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function H(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function U(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Y(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t[4]=e[4]+n[4]*i,t[5]=e[5]+n[5]*i,t[6]=e[6]+n[6]*i,t[7]=e[7]+n[7]*i,t[8]=e[8]+n[8]*i,t[9]=e[9]+n[9]*i,t[10]=e[10]+n[10]*i,t[11]=e[11]+n[11]*i,t[12]=e[12]+n[12]*i,t[13]=e[13]+n[13]*i,t[14]=e[14]+n[14]*i,t[15]=e[15]+n[15]*i,t}function W(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function G(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=t[8],d=t[9],h=t[10],p=t[11],f=t[12],m=t[13],v=t[14],g=t[15],_=e[0],b=e[1],y=e[2],x=e[3],w=e[4],M=e[5],E=e[6],S=e[7],A=e[8],R=e[9],P=e[10],O=e[11],T=e[12],C=e[13],N=e[14],I=e[15];return Math.abs(n-_)<=X.EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-b)<=X.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(r-y)<=X.EPSILON*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(o-x)<=X.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-w)<=X.EPSILON*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-M)<=X.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-E)<=X.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(l-S)<=X.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(c-A)<=X.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(d-R)<=X.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(h-P)<=X.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(p-O)<=X.EPSILON*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(f-T)<=X.EPSILON*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(m-C)<=X.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(v-N)<=X.EPSILON*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(g-I)<=X.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))}Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=i,e.clone=r,e.copy=o,e.fromValues=a,e.set=s,e.identity=u,e.transpose=l,e.invert=c,e.adjoint=d,e.determinant=h,e.multiply=p,e.translate=f,e.scale=m,e.rotate=v,e.rotateX=g,e.rotateY=_,e.rotateZ=b,e.fromTranslation=y,e.fromScaling=x,e.fromRotation=w,e.fromXRotation=M,e.fromYRotation=E,e.fromZRotation=S,e.fromRotationTranslation=A,e.getTranslation=R,e.getScaling=P,e.getRotation=O,e.fromRotationTranslationScale=T,e.fromRotationTranslationScaleOrigin=C,e.fromQuat=N,e.frustum=I,e.perspective=L,e.perspectiveFromFieldOfView=D,e.ortho=F,e.lookAt=k,e.targetTo=B,e.str=V,e.frob=z,e.add=j,e.subtract=H,e.multiplyScalar=U,e.multiplyScalarAndAdd=Y,e.exactEquals=W,e.equals=G;var q=n(0),X=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(q);e.mul=p,e.sub=H},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(){var t=new y.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function o(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function a(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function s(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return 0!=i?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n}function u(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=i*c+a*s+r*l-o*u,t[1]=r*c+a*u+o*s-i*l,t[2]=o*c+a*l+i*u-r*s,t[3]=a*c-i*s-r*u-o*l,t}function l(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+a*s,t[1]=r*u+o*s,t[2]=o*u-r*s,t[3]=a*u-i*s,t}function c(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u-o*s,t[1]=r*u+a*s,t[2]=o*u+i*s,t[3]=a*u-r*s,t}function d(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=i*u+r*s,t[1]=r*u-i*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function h(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function p(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3],u=n[0],l=n[1],c=n[2],d=n[3],h=void 0,p=void 0,f=void 0,m=void 0,v=void 0;return p=r*u+o*l+a*c+s*d,p<0&&(p=-p,u=-u,l=-l,c=-c,d=-d),1-p>1e-6?(h=Math.acos(p),f=Math.sin(h),m=Math.sin((1-i)*h)/f,v=Math.sin(i*h)/f):(m=1-i,v=i),t[0]=m*r+v*u,t[1]=m*o+v*l,t[2]=m*a+v*c,t[3]=m*s+v*d,t}function f(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-i*s,t[2]=-r*s,t[3]=o*s,t}function m(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function v(t,e){var n=e[0]+e[4]+e[8],i=void 0;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,a=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*a+a]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*o+a]-e[3*a+o])*i,t[o]=(e[3*o+r]+e[3*r+o])*i,t[a]=(e[3*a+r]+e[3*r+a])*i}return t}function g(t,e,n,i){var r=.5*Math.PI/180;e*=r,n*=r,i*=r;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),l=Math.sin(i),c=Math.cos(i);return t[0]=o*u*c-a*s*l,t[1]=a*s*c+o*u*l,t[2]=a*u*l-o*s*c,t[3]=a*u*c+o*s*l,t}function _(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=r,e.identity=o,e.setAxisAngle=a,e.getAxisAngle=s,e.multiply=u,e.rotateX=l,e.rotateY=c,e.rotateZ=d,e.calculateW=h,e.slerp=p,e.invert=f,e.conjugate=m,e.fromMat3=v,e.fromEuler=g,e.str=_;var b=n(0),y=i(b),x=n(1),w=i(x),M=n(2),E=i(M),S=n(3),A=i(S),R=(e.clone=A.clone,e.fromValues=A.fromValues,e.copy=A.copy,e.set=A.set,e.add=A.add,e.mul=u,e.scale=A.scale,e.dot=A.dot,e.lerp=A.lerp,e.length=A.length),P=(e.len=R,e.squaredLength=A.squaredLength),O=(e.sqrLen=P,e.normalize=A.normalize);e.exactEquals=A.exactEquals,e.equals=A.equals,e.rotationTo=function(){var t=E.create(),e=E.fromValues(1,0,0),n=E.fromValues(0,1,0);return function(i,r,o){var s=E.dot(r,o);return s<-.999999?(E.cross(t,e,r),E.len(t)<1e-6&&E.cross(t,n,r),E.normalize(t,t),a(i,t,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(E.cross(t,r,o),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+s,O(i,i))}}(),e.sqlerp=function(){var t=r(),e=r();return function(n,i,r,o,a,s){return p(t,i,a,s),p(e,r,o,s),p(n,t,e,2*s*(1-s)),n}}(),e.setAxes=function(){var t=w.create();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],O(e,v(e,t))}}()},function(t,e,n){"use strict";function i(){var t=new B.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function r(t){var e=new B.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e}function o(t,e){var n=new B.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n}function a(t,e){return t[0]=e[0],t[1]=e[1],t}function s(t,e,n){return t[0]=e,t[1]=n,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function l(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function c(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function d(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function h(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function p(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function f(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function m(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function v(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function g(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function _(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t}function b(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(n*n+i*i)}function y(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i}function x(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function w(t){var e=t[0],n=t[1];return e*e+n*n}function M(t,e){return t[0]=-e[0],t[1]=-e[1],t}function E(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function S(t,e){var n=e[0],i=e[1],r=n*n+i*i;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t}function A(t,e){return t[0]*e[0]+t[1]*e[1]}function R(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t}function P(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}function O(t,e){e=e||1;var n=2*B.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function T(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t}function C(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function N(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function I(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}function L(t){return"vec2("+t[0]+", "+t[1]+")"}function D(t,e){return t[0]===e[0]&&t[1]===e[1]}function F(t,e){var n=t[0],i=t[1],r=e[0],o=e[1];return Math.abs(n-r)<=B.EPSILON*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(i-o)<=B.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))}Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=i,e.clone=r,e.fromValues=o,e.copy=a,e.set=s,e.add=u,e.subtract=l,e.multiply=c,e.divide=d,e.ceil=h,e.floor=p,e.min=f,e.max=m,e.round=v,e.scale=g,e.scaleAndAdd=_,e.distance=b,e.squaredDistance=y,e.length=x,e.squaredLength=w,e.negate=M,e.inverse=E,e.normalize=S,e.dot=A,e.cross=R,e.lerp=P,e.random=O,e.transformMat2=T,e.transformMat2d=C,e.transformMat3=N,e.transformMat4=I,e.str=L,e.exactEquals=D,e.equals=F;var k=n(0),B=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(k);e.len=x,e.sub=l,e.mul=c,e.div=d,e.dist=b,e.sqrDist=y,e.sqrLen=w,e.forEach=function(){var t=i();return function(e,n,i,r,o,a){var s=void 0,u=void 0;for(n||(n=2),i||(i=0),u=r?Math.min(r*n+i,e.length):e.length,s=i;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}()}])})},{}],7:[function(t,e,n){function i(t,e,n){if(null!=t)for(var i=-1,r=t.length;++i<r&&!1!==e.call(n,t[i],i,t););}e.exports=i},{}],8:[function(t,e,n){function i(t,e,n){var i=t.length;e=null==e?0:e<0?Math.max(i+e,0):Math.min(e,i),n=null==n?i:n<0?Math.max(i+n,0):Math.min(n,i);for(var r=[];e<n;)r.push(t[e++]);return r}e.exports=i},{}],9:[function(t,e,n){function i(t){switch(u(t)){case"Object":return r(t);case"Array":return s(t);case"RegExp":return o(t);case"Date":return a(t);default:return t}}function r(t){return l(t)?c({},t):t}function o(t){var e="";return e+=t.multiline?"m":"",e+=t.global?"g":"",e+=t.ignoreCase?"i":"",new RegExp(t.source,e)}function a(t){return new Date(+t)}function s(t){return t.slice()}var u=t(15),l=t(14),c=t(22);e.exports=i},{14:14,15:15,22:22}],10:[function(t,e,n){function i(t,e){switch(u(t)){case"Object":return r(t,e);case"Array":return o(t,e);default:return a(t)}}function r(t,e){if(l(t)){var n={};return s(t,function(t,n){this[n]=i(t,e)},n),n}return e?e(t):t}function o(t,e){for(var n=[],r=-1,o=t.length;++r<o;)n[r]=i(t[r],e);return n}var a=t(9),s=t(18),u=t(15),l=t(14);e.exports=i},{14:14,15:15,18:18,9:9}],11:[function(t,e,n){var i=t(12),r=Array.isArray||function(t){return i(t,"Array")};e.exports=r},{12:12}],12:[function(t,e,n){function i(t,e){return r(t)===e}var r=t(15);e.exports=i},{15:15}],13:[function(t,e,n){function i(t){return r(t,"Object")}var r=t(12);e.exports=i},{12:12}],14:[function(t,e,n){function i(t){return!!t&&"object"==typeof t&&t.constructor===Object}e.exports=i},{}],15:[function(t,e,n){function i(t){return null===t?"Null":t===r?"Undefined":o.exec(a.call(t))[1]}var r,o=/^\[object (.*)\]$/,a=Object.prototype.toString;e.exports=i},{}],16:[function(t,e,n){function i(t,e){return r(o(arguments,1),function(e){a(e,function(e,n){null==t[n]&&(t[n]=e)})}),t}var r=t(7),o=t(8),a=t(18);e.exports=i},{18:18,7:7,8:8}],17:[function(t,e,n){function i(){s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=!0;for(var t in{toString:null})a=!1}function r(t,e,n){var r,l=0;null==a&&i();for(r in t)if(!1===o(e,t,r,n))break;if(a)for(var c=t.constructor,d=!!c&&t===c.prototype;(r=s[l++])&&("constructor"===r&&(d||!u(t,r))||t[r]===Object.prototype[r]||!1!==o(e,t,r,n)););}function o(t,e,n,i){return t.call(i,e[n],n,e)}var a,s,u=t(19);e.exports=r},{19:19}],18:[function(t,e,n){function i(t,e,n){o(t,function(i,o){if(r(t,o))return e.call(n,t[o],o,t)})}var r=t(19),o=t(17);e.exports=i},{17:17,19:19}],19:[function(t,e,n){function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=i},{}],20:[function(t,e,n){var i=t(18),r=Object.keys||function(t){var e=[];return i(t,function(t,n){e.push(n)}),e};e.exports=r},{18:18}],21:[function(t,e,n){function i(){var t,e,n,s,u=1;for(s=o(arguments[0]);n=arguments[u++];)for(t in n)r(n,t)&&(e=n[t],a(e)&&a(s[t])?s[t]=i(s[t],e):s[t]=o(e));return s}var r=t(19),o=t(10),a=t(13);e.exports=i},{10:10,13:13,19:19}],22:[function(t,e,n){function i(t,e){for(var n,i=0,a=arguments.length;++i<a;)null!=(n=arguments[i])&&o(n,r,t);return t}function r(t,e){this[e]=t}var o=t(18);e.exports=i},{18:18}],23:[function(t,e,n){function i(t,e){for(var n,i,s,u,l=(t||"").replace("?","").split("&"),c=-1,d={};i=l[++c];)n=i.indexOf("="),u=i.substring(0,n),s=decodeURIComponent(i.substring(n+1)),!1!==e&&(s=r(s)),a(d,u)?o(d[u])?d[u].push(s):d[u]=[d[u],s]:d[u]=s;return d}var r=t(27),o=t(11),a=t(19);e.exports=i},{11:11,19:19,27:27}],24:[function(t,e,n){function i(t){var e,n,i=[];return r(t,function(t,r){o(t)?(e=r+"=",n=new RegExp("&"+r+"+=$"),a(t,function(t){e+=encodeURIComponent(t)+"&"+r+"="}),i.push(e.replace(n,""))):i.push(r+"="+encodeURIComponent(t))}),i.length?"?"+i.join("&"):""}var r=t(18),o=t(11),a=t(7);e.exports=i},{11:11,18:18,7:7}],25:[function(t,e,n){function i(t){t=t.replace(/#.*/,"");var e=/\?[a-zA-Z0-9\=\&\%\$\-\_\.\+\!\*\'\(\)\,]+/.exec(t);return e?decodeURIComponent(e[0].replace(/\+/g," ")):""}e.exports=i},{}],26:[function(t,e,n){function i(t,e){return r(o(t),e)}var r=t(23),o=t(25);e.exports=i},{23:23,25:25}],27:[function(t,e,n){function i(t){return null===t||"null"===t?null:"true"===t||"false"!==t&&(t===r||"undefined"===t?r:""===t||isNaN(t)?t:parseFloat(t))}var r;e.exports=i},{}],28:[function(t,e,n){(function(t){(function(){var n,i,r;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:void 0!==t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-r)/1e6},i=t.hrtime,n=function(){var t;return t=i(),1e9*t[0]+t[1]},r=n()):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(this,t(30))},{30:30}],29:[function(t,e,n){var i=null;e.exports=function(t){var e=["Moz","Khtml","Webkit","O","ms"],n=t.charAt(0).toUpperCase()+t.slice(1);if(i||(i=document.createElement("div")),t in i.style)return t;for(var r=e.length;r--;)if(e[r]+n in i.style)return e[r]+n;return!1}},{}],30:[function(t,e,n){function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(d===setTimeout)return setTimeout(t,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(t,0);try{return d(t,0)}catch(e){try{return d.call(null,t,0)}catch(e){return d.call(this,t,0)}}}function a(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function s(){v&&f&&(v=!1,f.length?m=f.concat(m):g=-1,m.length&&u())}function u(){if(!v){var t=o(s);v=!0;for(var e=m.length;e;){for(f=m,m=[];++g<e;)f&&f[g].run();g=-1,e=m.length}f=null,v=!1,a(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var d,h,p=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(t){d=i}try{h="function"==typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var f,m=[],v=!1,g=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];m.push(new l(t,e)),1!==m.length||v||o(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],31:[function(t,e,n){for(var i=t(28),r="undefined"==typeof window?{}:window,o=["moz","webkit"],a="AnimationFrame",s=r["request"+a],u=r["cancel"+a]||r["cancelRequest"+a],l=0;l<o.length&&!s;l++)s=r[o[l]+"Request"+a],u=r[o[l]+"Cancel"+a]||r[o[l]+"CancelRequest"+a];if(!s||!u){var c=0,d=0,h=[];s=function(t){if(0===h.length){var e=i(),n=Math.max(0,1e3/60-(e-c));c=n+e,setTimeout(function(){var t=h.slice(0);h.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(c)}catch(t){setTimeout(function(){throw t},0)}},Math.round(n))}return h.push({handle:++d,callback:t,cancelled:!1}),d},u=function(t){for(var e=0;e<h.length;e++)h[e].handle===t&&(h[e].cancelled=!0)}}e.exports=function(t){return s.call(r,t)},e.exports.cancel=function(){u.apply(r,arguments)}},{28:28}],32:[function(t,e,n){!function(t,i){"object"==typeof n&&void 0!==e?e.exports=i():"function"==typeof define&&define.amd?define(i):t.Stats=i()}(this,function(){"use strict";var t=function(){function e(t){return r.appendChild(t.dom),t}function n(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";i=t}var i=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(t){t.preventDefault(),n(++i%r.children.length)},!1);var o=(performance||Date).now(),a=o,s=0,u=e(new t.Panel("FPS","#0ff","#002")),l=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=e(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:r,addPanel:e,showPanel:n,begin:function(){o=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(l.update(t-o,200),t>a+1e3&&(u.update(1e3*s/(t-a),100),a=t,s=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:r,setMode:n}};return t.Panel=function(t,e,n){var i=1/0,r=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,u=48*a,l=3*a,c=2*a,d=3*a,h=15*a,p=74*a,f=30*a,m=document.createElement("canvas");m.width=s,m.height=u,m.style.cssText="width:80px;height:48px";var v=m.getContext("2d");return v.font="bold "+9*a+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,s,u),v.fillStyle=e,v.fillText(t,l,c),v.fillRect(d,h,p,f),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(d,h,p,f),{dom:m,update:function(u,g){i=Math.min(i,u),r=Math.max(r,u),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,s,h),v.fillStyle=e,v.fillText(o(u)+" "+t+" ("+o(i)+"-"+o(r)+")",l,c),v.drawImage(m,d+a,h,p-a,f,d,h,p-a,f),v.fillRect(d+p-a,h,a,f),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(d+p-a,h,a,o((1-u/g)*f))}}},t})},{}],33:[function(t,e,n){e.exports=window.THREE},{}],34:[function(t,e,n){function i(t){return r(t).replace(/\s(\w)/g,function(t,e){return e.toUpperCase()})}var r=t(36);e.exports=i},{36:36}],35:[function(t,e,n){function i(t){return a.test(t)?t.toLowerCase():(u.test(t)&&(t=r(t)),s.test(t)&&(t=o(t)),t.toLowerCase())}function r(t){return t.replace(l,function(t,e){return e?" "+e:""})}function o(t){return t.replace(c,function(t,e,n){return e+" "+n.toLowerCase().split("").join(" ")})}e.exports=i;var a=/\s/,s=/[a-z][A-Z]/,u=/[\W_]/,l=/[\W_]+(.|$)/g,c=/(.)([A-Z]+)/g},{}],36:[function(t,e,n){function i(t){return r(t).replace(/[\W_]+(.|$)/g,function(t,e){return e?" "+e:""})}var r=t(35);e.exports=i},{35:35}],37:[function(t,e,n){(function(){function t(t){function e(e,n,i,r,o,a){for(;o>=0&&o<a;o+=t){var s=r?r[o]:o;i=n(i,e[s],s,e)}return i}return function(n,i,r,o){i=x(i,o,4);var a=!P(n)&&y.keys(n),s=(a||n).length,u=t>0?0:s-1;return arguments.length<3&&(r=n[a?a[u]:u],u+=t),e(n,i,r,a,u,s)}}function i(t){return function(e,n,i){n=w(n,i);for(var r=R(e),o=t>0?0:r-1;o>=0&&o<r;o+=t)if(n(e[o],o,e))return o;return-1}}function r(t,e,n){return function(i,r,o){var a=0,s=R(i);if("number"==typeof o)t>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return o=n(i,r),i[o]===r?o:-1;if(r!==r)return o=e(h.call(i,a,s),y.isNaN),o>=0?o+a:-1;for(o=t>0?a:s-1;o>=0&&o<s;o+=t)if(i[o]===r)return o;return-1}}function o(t,e){var n=I.length,i=t.constructor,r=y.isFunction(i)&&i.prototype||l,o="constructor";for(y.has(t,o)&&!y.contains(e,o)&&e.push(o);n--;)(o=I[n])in t&&t[o]!==r[o]&&!y.contains(e,o)&&e.push(o)}var a=this,s=a._,u=Array.prototype,l=Object.prototype,c=Function.prototype,d=u.push,h=u.slice,p=l.toString,f=l.hasOwnProperty,m=Array.isArray,v=Object.keys,g=c.bind,_=Object.create,b=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=y),n._=y):a._=y,y.VERSION="1.8.3";var x=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)};case 4:return function(n,i,r,o){return t.call(e,n,i,r,o)}}return function(){return t.apply(e,arguments)}},w=function(t,e,n){return null==t?y.identity:y.isFunction(t)?x(t,e,n):y.isObject(t)?y.matcher(t):y.property(t)};y.iteratee=function(t,e){return w(t,e,1/0)};var M=function(t,e){return function(n){var i=arguments.length;if(i<2||null==n)return n;for(var r=1;r<i;r++)for(var o=arguments[r],a=t(o),s=a.length,u=0;u<s;u++){var l=a[u];e&&void 0!==n[l]||(n[l]=o[l])}return n}},E=function(t){if(!y.isObject(t))return{};if(_)return _(t);b.prototype=t;var e=new b;return b.prototype=null,e},S=function(t){return function(e){return null==e?void 0:e[t]}},A=Math.pow(2,53)-1,R=S("length"),P=function(t){var e=R(t);return"number"==typeof e&&e>=0&&e<=A};y.each=y.forEach=function(t,e,n){e=x(e,n);var i,r;if(P(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var o=y.keys(t);for(i=0,r=o.length;i<r;i++)e(t[o[i]],o[i],t)}return t},y.map=y.collect=function(t,e,n){e=w(e,n);for(var i=!P(t)&&y.keys(t),r=(i||t).length,o=Array(r),a=0;a<r;a++){var s=i?i[a]:a;o[a]=e(t[s],s,t)}return o},y.reduce=y.foldl=y.inject=t(1),y.reduceRight=y.foldr=t(-1),y.find=y.detect=function(t,e,n){var i;if(void 0!==(i=P(t)?y.findIndex(t,e,n):y.findKey(t,e,n))&&-1!==i)return t[i]},y.filter=y.select=function(t,e,n){var i=[];return e=w(e,n),y.each(t,function(t,n,r){e(t,n,r)&&i.push(t)}),i},y.reject=function(t,e,n){return y.filter(t,y.negate(w(e)),n)},y.every=y.all=function(t,e,n){e=w(e,n);for(var i=!P(t)&&y.keys(t),r=(i||t).length,o=0;o<r;o++){var a=i?i[o]:o;if(!e(t[a],a,t))return!1}return!0},y.some=y.any=function(t,e,n){e=w(e,n);for(var i=!P(t)&&y.keys(t),r=(i||t).length,o=0;o<r;o++){var a=i?i[o]:o;if(e(t[a],a,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,n,i){return P(t)||(t=y.values(t)),("number"!=typeof n||i)&&(n=0),y.indexOf(t,e,n)>=0},y.invoke=function(t,e){var n=h.call(arguments,2),i=y.isFunction(e);return y.map(t,function(t){var r=i?e:t[e];return null==r?r:r.apply(t,n)})},y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,n){var i,r,o=-1/0,a=-1/0;if(null==e&&null!=t){t=P(t)?t:y.values(t);for(var s=0,u=t.length;s<u;s++)(i=t[s])>o&&(o=i)}else e=w(e,n),y.each(t,function(t,n,i){((r=e(t,n,i))>a||r===-1/0&&o===-1/0)&&(o=t,a=r)});return o},y.min=function(t,e,n){var i,r,o=1/0,a=1/0;if(null==e&&null!=t){t=P(t)?t:y.values(t);for(var s=0,u=t.length;s<u;s++)(i=t[s])<o&&(o=i)}else e=w(e,n),y.each(t,function(t,n,i){((r=e(t,n,i))<a||r===1/0&&o===1/0)&&(o=t,a=r)});return o},y.shuffle=function(t){for(var e,n=P(t)?t:y.values(t),i=n.length,r=Array(i),o=0;o<i;o++)e=y.random(0,o),e!==o&&(r[o]=r[e]),r[e]=n[o];return r},y.sample=function(t,e,n){return null==e||n?(P(t)||(t=y.values(t)),t[y.random(t.length-1)]):y.shuffle(t).slice(0,Math.max(0,e))},y.sortBy=function(t,e,n){return e=w(e,n),y.pluck(y.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var O=function(t){return function(e,n,i){var r={};return n=w(n,i),y.each(e,function(i,o){var a=n(i,o,e);t(r,i,a)}),r}};y.groupBy=O(function(t,e,n){y.has(t,n)?t[n].push(e):t[n]=[e]}),y.indexBy=O(function(t,e,n){t[n]=e}),y.countBy=O(function(t,e,n){y.has(t,n)?t[n]++:t[n]=1}),y.toArray=function(t){return t?y.isArray(t)?h.call(t):P(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:P(t)?t.length:y.keys(t).length},y.partition=function(t,e,n){e=w(e,n);var i=[],r=[];return y.each(t,function(t,n,o){(e(t,n,o)?i:r).push(t)}),[i,r]},y.first=y.head=y.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,n){return h.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},y.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,n){return h.call(t,null==e||n?1:e)},y.compact=function(t){return y.filter(t,y.identity)};var T=function(t,e,n,i){for(var r=[],o=0,a=i||0,s=R(t);a<s;a++){var u=t[a];if(P(u)&&(y.isArray(u)||y.isArguments(u))){e||(u=T(u,e,n));var l=0,c=u.length;for(r.length+=c;l<c;)r[o++]=u[l++]}else n||(r[o++]=u)}return r};y.flatten=function(t,e){return T(t,e,!1)},y.without=function(t){return y.difference(t,h.call(arguments,1))},y.uniq=y.unique=function(t,e,n,i){y.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=w(n,i));for(var r=[],o=[],a=0,s=R(t);a<s;a++){var u=t[a],l=n?n(u,a,t):u;e?(a&&o===l||r.push(u),o=l):n?y.contains(o,l)||(o.push(l),r.push(u)):y.contains(r,u)||r.push(u)}return r},y.union=function(){return y.uniq(T(arguments,!0,!0))},y.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=R(t);i<r;i++){var o=t[i];if(!y.contains(e,o)){for(var a=1;a<n&&y.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},y.difference=function(t){var e=T(arguments,!0,!0,1);return y.filter(t,function(t){return!y.contains(e,t)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(t){for(var e=t&&y.max(t,R).length||0,n=Array(e),i=0;i<e;i++)n[i]=y.pluck(t,i);return n},y.object=function(t,e){for(var n={},i=0,r=R(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},y.findIndex=i(1),y.findLastIndex=i(-1),y.sortedIndex=function(t,e,n,i){n=w(n,i,1);for(var r=n(e),o=0,a=R(t);o<a;){var s=Math.floor((o+a)/2);n(t[s])<r?o=s+1:a=s}return o},y.indexOf=r(1,y.findIndex,y.sortedIndex),y.lastIndexOf=r(-1,y.findLastIndex),y.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),o=0;o<i;o++,t+=n)r[o]=t;return r};var C=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var o=E(t.prototype),a=t.apply(o,r);return y.isObject(a)?a:o};y.bind=function(t,e){if(g&&t.bind===g)return g.apply(t,h.call(arguments,1));if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var n=h.call(arguments,2),i=function(){return C(t,i,e,this,n.concat(h.call(arguments)))};return i},y.partial=function(t){var e=h.call(arguments,1),n=function(){for(var i=0,r=e.length,o=Array(r),a=0;a<r;a++)o[a]=e[a]===y?arguments[i++]:e[a];for(;i<arguments.length;)o.push(arguments[i++]);return C(t,n,this,this,o)};return n},y.bindAll=function(t){var e,n,i=arguments.length;if(i<=1)throw new Error("bindAll must be passed function names");for(e=1;e<i;e++)n=arguments[e],t[n]=y.bind(t[n],t);return t},y.memoize=function(t,e){var n=function(i){var r=n.cache,o=""+(e?e.apply(this,arguments):i);return y.has(r,o)||(r[o]=t.apply(this,arguments)),r[o]};return n.cache={},n},y.delay=function(t,e){var n=h.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,n){var i,r,o,a=null,s=0;n||(n={});var u=function(){s=!1===n.leading?0:y.now(),a=null,o=t.apply(i,r),a||(i=r=null)};return function(){var l=y.now();s||!1!==n.leading||(s=l);var c=e-(l-s);return i=this,r=arguments,c<=0||c>e?(a&&(clearTimeout(a),a=null),s=l,o=t.apply(i,r),a||(i=r=null)):a||!1===n.trailing||(a=setTimeout(u,c)),o}},y.debounce=function(t,e,n){var i,r,o,a,s,u=function(){var l=y.now()-a;l<e&&l>=0?i=setTimeout(u,e-l):(i=null,n||(s=t.apply(o,r),i||(o=r=null)))};return function(){o=this,r=arguments,a=y.now();var l=n&&!i;return i||(i=setTimeout(u,e)),l&&(s=t.apply(o,r),o=r=null),s}},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},y.once=y.partial(y.before,2);var N=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(t){if(!y.isObject(t))return[];if(v)return v(t);var e=[];for(var n in t)y.has(t,n)&&e.push(n);return N&&o(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var n in t)e.push(n);return N&&o(t,e),e},y.values=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},y.mapObject=function(t,e,n){e=w(e,n);for(var i,r=y.keys(t),o=r.length,a={},s=0;s<o;s++)i=r[s],a[i]=e(t[i],i,t);return a},y.pairs=function(t){for(var e=y.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},y.invert=function(t){for(var e={},n=y.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},y.functions=y.methods=function(t){var e=[];for(var n in t)y.isFunction(t[n])&&e.push(n);return e.sort()},y.extend=M(y.allKeys),y.extendOwn=y.assign=M(y.keys),y.findKey=function(t,e,n){e=w(e,n)
;for(var i,r=y.keys(t),o=0,a=r.length;o<a;o++)if(i=r[o],e(t[i],i,t))return i},y.pick=function(t,e,n){var i,r,o={},a=t;if(null==a)return o;y.isFunction(e)?(r=y.allKeys(a),i=x(e,n)):(r=T(arguments,!1,!1,1),i=function(t,e,n){return e in n},a=Object(a));for(var s=0,u=r.length;s<u;s++){var l=r[s],c=a[l];i(c,l,a)&&(o[l]=c)}return o},y.omit=function(t,e,n){if(y.isFunction(e))e=y.negate(e);else{var i=y.map(T(arguments,!1,!1,1),String);e=function(t,e){return!y.contains(i,e)}}return y.pick(t,e,n)},y.defaults=M(y.allKeys,!0),y.create=function(t,e){var n=E(t);return e&&y.extendOwn(n,e),n},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var n=y.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),o=0;o<i;o++){var a=n[o];if(e[a]!==r[a]||!(a in r))return!1}return!0};var L=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var r=p.call(t);if(r!==p.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var o="[object Array]"===r;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,s=e.constructor;if(a!==s&&!(y.isFunction(a)&&a instanceof a&&y.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],i=i||[];for(var u=n.length;u--;)if(n[u]===t)return i[u]===e;if(n.push(t),i.push(e),o){if((u=t.length)!==e.length)return!1;for(;u--;)if(!L(t[u],e[u],n,i))return!1}else{var l,c=y.keys(t);if(u=c.length,y.keys(e).length!==u)return!1;for(;u--;)if(l=c[u],!y.has(e,l)||!L(t[l],e[l],n,i))return!1}return n.pop(),i.pop(),!0};y.isEqual=function(t,e){return L(t,e)},y.isEmpty=function(t){return null==t||(P(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=m||function(t){return"[object Array]"===p.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){y["is"+t]=function(e){return p.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return y.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&t!==+t},y.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===p.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){return null!=t&&f.call(t,e)},y.noConflict=function(){return a._=s,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=S,y.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,n){var i=Array(Math.max(0,t));e=x(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},F=y.invert(D),k=function(t){var e=function(e){return t[e]},n="(?:"+y.keys(t).join("|")+")",i=RegExp(n),r=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,e):t}};y.escape=k(D),y.unescape=k(F),y.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),y.isFunction(i)?i.call(t):i};var B=0;y.uniqueId=function(t){var e=++B+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\u2028|\u2029/g,H=function(t){return"\\"+z[t]};y.template=function(t,e,n){!e&&n&&(e=n),e=y.defaults({},e,y.templateSettings);var i=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,function(e,n,i,a,s){return o+=t.slice(r,s).replace(j,H),r=s+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var a=new Function(e.variable||"obj","_",o)}catch(t){throw t.source=o,t}var s=function(t){return a.call(this,t,y)};return s.source="function("+(e.variable||"obj")+"){\n"+o+"}",s},y.chain=function(t){var e=y(t);return e._chain=!0,e};var U=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){y.each(y.functions(t),function(e){var n=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return d.apply(t,arguments),U(this,n.apply(y,t))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=u[t];y.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],U(this,n)}}),y.each(["concat","join","slice"],function(t){var e=u[t];y.prototype[t]=function(){return U(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}).call(this)},{}],38:[function(t,e,n){function i(t,e,n){return e?new o(t,e):new o(t)}var r=function(){return this}(),o=r.WebSocket||r.MozWebSocket;e.exports=o?i:null,o&&(i.prototype=o.prototype)},{}],39:[function(t,e,n){THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*f.autoRotateSpeed}function i(){return Math.pow(.95,f.zoomSpeed)}function r(t){if(!1!==f.enabled){if(t.preventDefault(),t.button===f.mouseButtons.ORBIT){if(!0===f.noRotate)return;I=N.ROTATE,m.set(t.clientX,t.clientY)}else if(t.button===f.mouseButtons.ZOOM){if(!0===f.noZoom)return;I=N.DOLLY,M.set(t.clientX,t.clientY)}else if(t.button===f.mouseButtons.PAN){if(!0===f.noPan)return;I=N.PAN,_.set(t.clientX,t.clientY)}I!==N.NONE&&(document.addEventListener("mousemove",o,!1),document.addEventListener("mouseup",a,!1),f.dispatchEvent(k))}}function o(t){if(!1!==f.enabled){t.preventDefault();var e=f.domElement===document?f.domElement.body:f.domElement;if(I===N.ROTATE){if(!0===f.noRotate)return;v.set(t.clientX,t.clientY),g.subVectors(v,m),f.rotateLeft(2*Math.PI*g.x/e.clientWidth*f.rotateSpeed),f.rotateUp(2*Math.PI*g.y/e.clientHeight*f.rotateSpeed),m.copy(v)}else if(I===N.DOLLY){if(!0===f.noZoom)return;E.set(t.clientX,t.clientY),S.subVectors(E,M),S.y>0?f.dollyIn():S.y<0&&f.dollyOut(),M.copy(E)}else if(I===N.PAN){if(!0===f.noPan)return;b.set(t.clientX,t.clientY),y.subVectors(b,_),f.pan(y.x,y.y),_.copy(b)}I!==N.NONE&&f.update()}}function a(){!1!==f.enabled&&(document.removeEventListener("mousemove",o,!1),document.removeEventListener("mouseup",a,!1),f.dispatchEvent(B),I=N.NONE)}function s(t){if(!1!==f.enabled&&!0!==f.noZoom&&I===N.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?f.dollyOut():e<0&&f.dollyIn(),f.update(),f.dispatchEvent(k),f.dispatchEvent(B)}}function u(t){if(!1!==f.enabled&&!0!==f.noKeys&&!0!==f.noPan)switch(t.keyCode){case f.keys.UP:f.pan(0,f.keyPanSpeed),f.update();break;case f.keys.BOTTOM:f.pan(0,-f.keyPanSpeed),f.update();break;case f.keys.LEFT:f.pan(f.keyPanSpeed,0),f.update();break;case f.keys.RIGHT:f.pan(-f.keyPanSpeed,0),f.update()}}function l(t){if(!1!==f.enabled){switch(t.touches.length){case 1:if(!0===f.noRotate)return;I=N.TOUCH_ROTATE,m.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===f.noZoom)return;I=N.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);M.set(0,i);break;case 3:if(!0===f.noPan)return;I=N.TOUCH_PAN,_.set(t.touches[0].pageX,t.touches[0].pageY);break;default:I=N.NONE}I!==N.NONE&&f.dispatchEvent(k)}}function c(t){if(!1!==f.enabled){t.preventDefault(),t.stopPropagation();var e=f.domElement===document?f.domElement.body:f.domElement;switch(t.touches.length){case 1:if(!0===f.noRotate)return;if(I!==N.TOUCH_ROTATE)return;v.set(t.touches[0].pageX,t.touches[0].pageY),g.subVectors(v,m),f.rotateLeft(2*Math.PI*g.x/e.clientWidth*f.rotateSpeed),f.rotateUp(2*Math.PI*g.y/e.clientHeight*f.rotateSpeed),m.copy(v),f.update();break;case 2:if(!0===f.noZoom)return;if(I!==N.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(n*n+i*i);E.set(0,r),S.subVectors(E,M),S.y>0?f.dollyOut():S.y<0&&f.dollyIn(),M.copy(E),f.update();break;case 3:if(!0===f.noPan)return;if(I!==N.TOUCH_PAN)return;b.set(t.touches[0].pageX,t.touches[0].pageY),y.subVectors(b,_),f.pan(y.x,y.y),_.copy(b),f.update();break;default:I=N.NONE}}}function d(){!1!==f.enabled&&(f.dispatchEvent(B),I=N.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var h,p,f=this,m=new THREE.Vector2,v=new THREE.Vector2,g=new THREE.Vector2,_=new THREE.Vector2,b=new THREE.Vector2,y=new THREE.Vector2,x=new THREE.Vector3,w=new THREE.Vector3,M=new THREE.Vector2,E=new THREE.Vector2,S=new THREE.Vector2,A=0,R=0,P=1,O=new THREE.Vector3,T=new THREE.Vector3,C=new THREE.Quaternion,N={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},I=N.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var L=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),D=L.clone().inverse(),F={type:"change"},k={type:"start"},B={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=n()),R-=t},this.rotateUp=function(t){void 0===t&&(t=n()),A-=t},this.panLeft=function(t){var e=this.object.matrix.elements;x.set(e[0],e[1],e[2]),x.multiplyScalar(-t),O.add(x)},this.panUp=function(t){var e=this.object.matrix.elements;x.set(e[4],e[5],e[6]),x.multiplyScalar(t),O.add(x)},this.pan=function(t,e){var n=f.domElement===document?f.domElement.body:f.domElement;if(f.object instanceof THREE.PerspectiveCamera){var i=f.object.position,r=i.clone().sub(f.target),o=r.length();o*=Math.tan(f.object.fov/2*Math.PI/180),f.panLeft(2*t*o/n.clientHeight),f.panUp(2*e*o/n.clientHeight)}else f.object instanceof THREE.OrthographicCamera?(f.panLeft(t*(f.object.right-f.object.left)/n.clientWidth),f.panUp(e*(f.object.top-f.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=i()),f.object instanceof THREE.PerspectiveCamera?P/=t:f.object instanceof THREE.OrthographicCamera?(f.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),f.object.updateProjectionMatrix(),f.dispatchEvent(F)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=i()),f.object instanceof THREE.PerspectiveCamera?P*=t:f.object instanceof THREE.OrthographicCamera?(f.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),f.object.updateProjectionMatrix(),f.dispatchEvent(F)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var t=this.object.position;w.copy(t).sub(this.target),w.applyQuaternion(L),h=Math.atan2(w.x,w.z),p=Math.atan2(Math.sqrt(w.x*w.x+w.z*w.z),w.y),this.autoRotate&&I===N.NONE&&this.rotateLeft(n()),h+=R,p+=A,h=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,h)),p=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,p)),p=Math.max(1e-6,Math.min(Math.PI-1e-6,p));var e=w.length()*P;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(O),w.x=e*Math.sin(p)*Math.sin(h),w.y=e*Math.cos(p),w.z=e*Math.sin(p)*Math.cos(h),w.applyQuaternion(D),t.copy(this.target).add(w),this.object.lookAt(this.target),R=0,A=0,P=1,O.set(0,0,0),(T.distanceToSquared(this.object.position)>1e-6||8*(1-C.dot(this.object.quaternion))>1e-6)&&(this.dispatchEvent(F),T.copy(this.object.position),C.copy(this.object.quaternion))},this.reset=function(){I=N.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(F),this.update()},this.getPolarAngle=function(){return p},this.getAzimuthalAngle=function(){return h},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",r,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",c,!1),window.addEventListener("keydown",u,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,e.exports=THREE.OrbitControls},{}],40:[function(t,e,n){function i(t){a?(s=t,r()):t()}function r(){u=document.querySelector(".mobile"),u.style.display="block",l=document.querySelector(".mobile-bypass"),l.addEventListener("click",o)}function o(){u.parentNode.removeChild(u),s()}var a=/(iPad|iPhone|Android)/i.test(navigator.userAgent);n.pass=i;var s,u,l},{}],41:[function(t,e,n){function i(t){return t.replace(c,a)}function r(t){return t.replace(d,s)}function o(t){return t.replace(h,s)}function a(t,e){return l.ShaderChunk[e]+"\n"}function s(t,e){return e}function u(t){return t=i(t),t=r(t),o(t)}var l=t(33),c=/\/\/\s?chunk\(\s?(\w+)\s?\);/g,d=/(_\d+_\d+)(_\d+_\d+)+/g,h=/GLOBAL_VAR_([^\.\)\;\,\s]+)(_\d+)/g;e.exports=u},{33:33}],42:[function(t,e,n){function i(){function t(t,e){t=t.length?t:[t];for(var n,i=0,r=t.length;i<r;i++)n=t[i],n.__li.style.pointerEvents=e?"auto":"none",n.domElement.parentNode.style.opacity=e?1:.1}F.useStats&&(w=new C,N(w.domElement,{position:"absolute",left:"0px",top:"0px",zIndex:2048}),document.body.appendChild(w.domElement)),A=new L.WebGLRenderer({premultipliedAlpha:!1}),W.init(A),A.setClearColor(987152),A.shadowMap.type=L.PCFSoftShadowMap,A.shadowMap.enabled=!0,document.body.appendChild(A.domElement),S=new L.Scene,S.fog=new L.FogExp2(987152,75e-5),E=new L.PerspectiveCamera(45,1,1,3e3),E.position.set(0,3e3,5e3),M=new Y(E,A.domElement),M.noPan=!0,M.minDistance=250,M.minPolarAngle=.3,M.maxPolarAngle=Math.PI/2,M.target.y=100,M.update(),F.mouse=new L.Vector2(0,0),F.mouse3d=rt.origin,G.init(A,S,E),V.init(),S.add(V.mesh),R=new k,S.add(R),B.init(),S.add(B.mesh),z.init(A,R),x=new T.GUI;var e=x.addFolder("Simulator");e.add(F.query,"amount",F.amountList).onChange(function(){confirm("It will restart the demo")&&(window.location.href=window.location.href.split("#")[0]+U(F.query).replace("?","#"),window.location.reload())}),e.add(F,"gravity",-5,20),e.add(F,"particlesFromY",0,500).name("from Y"),e.add(F,"particlesYDynamicRange",-500,500).name("y dynamic range"),e.add(F,"particlesDropRadius",0,150).name("drop radius"),e.add(F,"handBounceRatio",0,1).name("hand bounce"),e.add(F,"handForce",0,.1).name("hand force");var n=x.addFolder("Post-Processing");n.add(F,"fxaa").listen(),X.maxDistance=120,X.motionMultiplier=4;var i=n.add(F,"motionBlur"),o=n.add(X,"maxDistance",1,300).name("motion distance").listen(),a=n.add(X,"motionMultiplier",.1,10).name("motion multiplier").listen(),v=n.add({lineTexture:"one third"},"lineTexture",["full","half","one third","quarter"]).name("motion quality").onChange(function(t){X.linesRenderTargetScale="full"===t?1:"half"===t?.5:"one third"===t?1/3:.25,X.resize()}),g=n.add(X,"fadeStrength",1,5).name("motion fade"),_=n.add(X,"opacity",0,1).name("motion opacity"),b=n.add(X,"jitter",0,1).name("motion jitter"),y=[o,a,v,g,_,b];i.onChange(t.bind(this,y)),t(y,F.motionBlur);var I=n.add(F,"bloom");y=[n.add(Q,"blurRadius",0,3).name("bloom radius"),n.add(Q,"amount",0,3).name("bloom amount")],I.onChange(t.bind(this,y)),t(y,F.bloom),n.add(F,"vignette");var q=function(t){t.preventDefault(),this.blur()};Array.prototype.forEach.call(x.domElement.querySelectorAll('input[type="checkbox"],select'),function(t){t.onkeyup=t.onkeydown=q,t.style.color="#000"}),P=document.querySelector(".logo"),O=document.querySelectorAll(".footer span"),x.domElement.addEventListener("mousedown",u),x.domElement.addEventListener("touchstart",u),window.addEventListener("click",s),window.addEventListener("mousedown",c),window.addEventListener("touchstart",l(c)),window.addEventListener("mousemove",d),window.addEventListener("touchmove",l(d)),window.addEventListener("mouseup",h),window.addEventListener("touchend",l(h)),window.addEventListener("resize",f);var J=r(j,H,{});J.pitch=function(){return this._pitch},J.yaw=function(){return this._yaw},J.roll=function(){return this._roll},p({hands:[J]},!0),D.loop(p),tt=Date.now(),f(),m()}function r(t,e,n){var i,s;for(var u in t)a(t,u)&&(i=t[u],s=e[u],"object"==typeof i?n[u]=r(i,s,i.length?[]:{}):isNaN(i)||Object.defineProperty(n,u,{get:o.bind(null,t,e,u)}));return n}function o(t,e,n){var i=t[n];return i+(e[n]-i)*it}function a(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function s(){ot=!0}function u(t){t.stopPropagation()}function l(t){return function(e){t(e.changedTouches[0])}}function c(){at=!0}function d(t){F.mouse.x=t.pageX/Z*2-1,F.mouse.y=-t.pageY/$*2+1}function h(){at=!1}function p(t,e){e||ut||(ut=!0),t.hands&&t.hands.length&&(lt=t.hands[0],st=!0,ot&&(ot=!1))}function f(){Z=window.innerWidth,$=window.innerHeight,G.resize(Z,$)}function m(){var t=Date.now();I(m),F.useStats&&w.begin(),b(t-tt,t),F.useStats&&w.end(),tt=t}function v(t,e,n){return t+(e-t)*n}function g(t,e,n){return t>n?n:t<e?e:t}function _(t,e,n){return g((n-t)/(e-t),0,1)}function b(t,e){et=Math.min(et+2e-4*t,1),nt=Math.min(nt+1e-4*t,1);var n=(Math.pow(et,.3),Math.pow(nt,.3));M.maxDistance=1===nt?1200:v(1400,500,n),M.update(),E.updateMatrixWorld(),rt.origin.setFromMatrixPosition(E.matrixWorld),rt.direction.set(F.mouse.x,F.mouse.y,.5).unproject(E).sub(rt.origin).normalize();var i=rt.origin.length()/Math.cos(Math.PI-rt.direction.angleTo(rt.origin));rt.origin.add(rt.direction.multiplyScalar(i)),ut===y?(it+=.01*((at?1:0)-it)*t,j.palmVelocity[0]=H.palmVelocity[0]=20*(rt.origin.x-R.position.x),j.palmVelocity[1]=H.palmVelocity[1]=20*(rt.origin.y-R.position.y),j.palmVelocity[2]=H.palmVelocity[2]=20*(rt.origin.z-R.position.z),R.position.copy(rt.origin)):(st||(j.palmVelocity[0]=j.palmVelocity[1]=j.palmVelocity[2]=0),R.position.x-=.05*R.position.x,R.position.y-=.05*R.position.y,R.position.z-=.05*R.position.z),R.leapUpdate(lt),z.update(t),V.update(t,E);var r=Math.min(1.2*(1-2*Math.abs(nt-.5)),1),o=10*(1-r);P.style.opacity=.2,P.style.display=r?"block":"none",P.style.webkitFilter="blur("+o+"px)",r=.8+.3*Math.pow(et,1.5),Z<580&&(r*=.5),P.style.transform="scale3d("+r+","+r+",1)";for(var a=0,s=O.length;a<s;a++)r=_(.5+.01*a,.6+.01*a,et),O[a].style.transform="translate3d(0,"+50*(1-Math.pow(r,3))+"px,0)";J.enabled=!!F.fxaa,X.enabled=!!F.motionBlur,q.enabled=!!F.vignette,Q.enabled=!!F.bloom,G.render(t,e),st=!1}var y,x,w,M,E,S,A,R,P,O,T=t(1),C=t(32),N=t(4),I=t(31),L=t(33),D=t(73),F=t(60),k=t(44),B=t(49),V=t(50),z=t(51),j=t(45),H=t(48),U=t(24),Y=t(39),W=t(47),G=t(58),q=t(59),X=t(57),J=t(55),q=t(59),Q=t(53),K=t(40),Z=0,$=0,tt=0,et=0,nt=0,it=0,rt=new L.Ray,ot=!1,at=!1,st=!1,ut=y,lt=y;K.pass(function(){var t=new Image;t.src="images/logo.png",t.width?i():t.onload=i})},{1:1,24:24,31:31,32:32,33:33,39:39,4:4,40:40,44:44,45:45,47:47,48:48,49:49,50:50,51:51,53:53,55:55,57:57,58:58,59:59,60:60,73:73}],43:[function(t,e,n){function i(t,e,n){l.Object3D.call(this),this.fingerIndex=t,this.fromNodeIndex=e,this.toNodeIndex=n,this.outputMatrix=new l.Matrix4,this.tmpPosition=new l.Vector3,this.tmpQuaternion=new l.Quaternion,this.tmpScale=new l.Vector3,this.nodeAdjustmentQuaternion=(new l.Quaternion).setFromAxisAngle(new l.Vector3(1,0,0),-Math.PI/2),this.bone=new l.Mesh(r(),c()),this.bone.motionMaterial=new u,this.bone.castShadow=!0,this.bone.receiveShadow=!0,this.add(this.bone),this.node=new l.Mesh(o(),c()),this.node.motionMaterial=new u,this.node.castShadow=!0,this.node.receiveShadow=!0,this.add(this.node)}function r(){return p||(p=new l.CylinderGeometry(1,1,1,12,1),p.translate(0,-.5,0)),p}function o(){return f||(f=new l.SphereGeometry(1,10,12)),f}function a(){var t=this.outputMatrix,e=this.tmpPosition,n=this.tmpQuaternion,i=this.tmpScale;return t.copy(this.bone.matrixWorld),t.decompose(e,n,i),t.compose(e,n,m),t.getInverse(t),t.elements[3]=i.x,t.elements[7]=i.y,t.elements[11]=i.z,Array.prototype.slice.call(t.elements)}function s(t){var e=t[this.fingerIndex],n=e.positions,i=n[this.fromNodeIndex],r=n[this.toNodeIndex],o=e.width/2;this.node.position.set(i[0],i[1],i[2]),this.bone.position.set(r[0],r[1],r[2]),this.bone.lookAt(this.node.position),this.node.scale.set(o,o,o);var a=this.bone.position.distanceTo(this.node.position);this.node.position.copy(this.bone.position),this.bone.scale.set(o,a,o),this.bone.quaternion.multiply(this.nodeAdjustmentQuaternion)}var u=(t(60),t(56)),l=t(33),c=t(61).getMaterial;e.exports=i;var d=l.Object3D.prototype,h=i.prototype=Object.create(d);h.constructor=i,h.updateOutputMatrix=a,h.leapUpdate=s;var p,f,m=new l.Vector3(1,1,1)},{33:33,56:56,60:60,61:61}],44:[function(t,e,n){function i(){u.Object3D.call(this),this.fingerBones=[],this.palmOutputMatrix=new u.Matrix4,this.tmpPosition=new u.Vector3,this.tmpQuaternion=new u.Quaternion,this.tmpScale=new u.Vector3;var t=(new u.Quaternion).setFromAxisAngle(new u.Vector3(1,0,0),-Math.PI/2);t.multiply((new u.Quaternion).setFromAxisAngle(new u.Vector3(0,0,1),Math.PI/6)),this.palmOutputAdjustmentMatrix=(new u.Matrix4).makeRotationFromQuaternion(t),this.palmMeshAdjustmentQuaternion=(new u.Quaternion).setFromAxisAngle(new u.Vector3(0,1,0),Math.PI/6),this.palmVelocity=new u.Vector3,this._initFingers(),this._initPalm()}function r(){for(var t,e=0;e<5;e++)for(var n=1;n<4;n++)t=new c(e,n,n+1),this.fingerBones.push(t),this.add(t)}function o(){var t=new u.CylinderGeometry(1,1,1,6);this.palm=new u.Mesh(t,d()),this.palm.motionMaterial=new l,this.palm.castShadow=!0,this.palm.receiveShadow=!0,this.add(this.palm)}function a(t){for(var e=t.fingers,n=this.fingerBones,i=0,r=n.length;i<r;i++)n[i].leapUpdate(e);this.palm.position.fromArray(t.palmPosition),this.palm.rotation.set(t.pitch(),-t.yaw(),t.roll()),this.palm.translateZ(20),this.palm.translateX(-5),this.palm.quaternion.multiply(this.palmMeshAdjustmentQuaternion);var o=(new u.Vector3).fromArray(t.pinky.positions[1]),a=(new u.Vector3).fromArray(t.thumb.positions[1]),s=.45*o.distanceTo(a);this.palm.scale.set(s,1.2*t.thumb.width,s),this.palmVelocity.fromArray(t.palmVelocity),this.updateMatrixWorld(),this.updateOutputMatrix()}function s(){var t=[],e=this.palmOutputMatrix,n=this.tmpPosition,i=this.tmpQuaternion,r=this.tmpScale;e.copy(this.palm.matrixWorld),e.multiply(this.palmOutputAdjustmentMatrix),e.decompose(n,i,r),e.compose(n,i,f),e.getInverse(e),e.elements[3]=.866025*r.x,e.elements[7]=.866025*r.y,e.elements[11]=r.z,t.push(Array.prototype.slice.call(e.elements));for(var o=this.fingerBones,a=0,s=o.length;a<s;a++)t.push(o[a].updateOutputMatrix()),o[a].updateOutputMatrix();return t}var u=(t(60),t(33)),l=t(56),c=t(43),d=t(61).getMaterial;e.exports=i;var h=u.Object3D.prototype,p=i.prototype=Object.create(h);p.constructor=i,p._initFingers=r,p._initPalm=o,p.leapUpdate=a,p.updateOutputMatrix=s;var f=new u.Vector3(1,1,1)},{33:33,43:43,56:56,60:60,61:61}],45:[function(t,e,n){e.exports={fingers:[{positions:[[-82.7319,33.8079,81.6507],[-82.7319,33.8079,81.6507],[-39.3405,53.4473,66.7093],[-8.43841,66.8659,61.464],[-3.5891,70.409,43.9993]],width:20.25},{positions:[[-96.16,53.3051,82.8463],[-55.7517,106.4,51.8535],[-31.345,135.869,32.3164],[-14.5136,145.228,17.7113],[-5.19045,147.288,9.40499]],width:19.3428},{positions:[[-104.87,55.9003,74.5382],[-73.2802,106.494,38.3453],[-48.4068,134.747,8.23954],[-28.5851,139.889,-11.4911],[-18.231,138.466,-20.5768]],width:18.9972},{positions:[[-112.945,55.4585,65.2907],[-91.7436,99.994,26.6792],[-70.4668,128.419,-.442044],[-51.3668,135.907,-19.0572],[-40.7008,136.068,-27.7728]],width:18.077},{positions:[[-118.298,48.5991,54.0274],[-106.452,89.7683,14.9498],[-93.3419,110.39,-10.6071],[-80.2055,114.368,-24.5409],[-70.0599,113.711,-32.0629]],width:16.0574}],palmPosition:[-81.83,83.3129,45.2651],palmVelocity:[0,0,0],_pitch:1.0615306607563884,_yaw:.6538980433882265,_roll:.7851885703254726,pinky:{positions:[0,[-106.452,89.7683,14.9498]]},thumb:{positions:[0,[-82.7319,33.8079,81.6507]],width:20.25}}},{}],46:[function(t,e,n){function i(t,e){g=t;var n=g.getContext();if(!n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS))return void alert("No support for vertex shader textures!");if(!n.getExtension("OES_texture_float"))return void alert("No OES_texture_float support for float textures!");x=[e.palmOutputMatrix];for(var i=0,r=e.fingerBones.length;i<r;i++)x.push(e.fingerBones[i].outputMatrix);b=new M.Scene,y=new M.Camera,y.position.z=1,c=new M.ShaderMaterial({uniforms:{resolution:{type:"v2",value:new M.Vector2(w.simulatorTextureWidth,w.simulatorTextureHeight)},texture:{type:"t",value:null}},vertexShader:E("#define GLSLIFY 1\nvoid main() {\n    gl_Position = vec4( position, 1.0 );\n}\n"),fragmentShader:E("#define GLSLIFY 1\nuniform vec2 resolution;\nuniform sampler2D texture;\n\nvoid main() {\n    vec2 uv = gl_FragCoord.xy / resolution.xy;\n    vec3 color = texture2D( texture, uv ).xyz;\n    gl_FragColor = vec4( color, 1.0 );\n}\n")}),d=new M.ShaderMaterial({uniforms:{texturePosition:{type:"t",value:null},textureVelocity:{type:"t",value:null},resolution:{type:"v2",value:new M.Vector2(w.simulatorTextureWidth,w.simulatorTextureHeight)},data:{type:"m4v",value:x},handBounceRatio:{type:"f",value:w.handBounceRatio},handForce:{type:"f",value:w.handForce},gravity:{type:"f",value:w.gravity},palmVelocity:{type:"v3",value:e.palmVelocity}},defines:{HAND_AMOUNT:w.hands,MATRIX_AMOUNT:16*w.hands},vertexShader:E("#define GLSLIFY 1\nvoid main() {\n    gl_Position = vec4( position, 1.0 );\n}\n"),fragmentShader:E("#define GLSLIFY 1\nuniform vec2 resolution;\n\nuniform sampler2D textureVelocity;\nuniform sampler2D texturePosition;\nuniform mat4 data[16];\nuniform vec3 palmVelocity;\n\nuniform float handBounceRatio;\nuniform float handForce;\nuniform float gravity;\n\nconst float INTERSECTION_PRECISION = 1.0;\nconst float FAR = 2000.0;\n\nfloat sdSphere( vec3 p, float s ) {\n  return length(p)-s;\n}\n\nfloat sdCappedCylinderLower( vec3 p, vec2 h ){\n  vec2 d = abs(vec2(length(p.xz),p.y + h.y)) - h;\n  return min(max(d.x,d.y),0.0) + length(max(d,0.0));\n}\n\nfloat sdFingerBone( in vec3 p, in mat4 fingerBone) {\n\n    vec3 scale = vec3(fingerBone[0][3], fingerBone[1][3], fingerBone[2][3]);\n\n    fingerBone[0][3] = 0.0;\n    fingerBone[1][3] = 0.0;\n    fingerBone[2][3] = 0.0;\n\n    p = (fingerBone * vec4(p, 1.0)).xyz;\n\n    return min(\n        sdSphere(p, scale.x),\n        sdCappedCylinderLower(p, vec2(scale.x, scale.y / 2.0))\n    );\n}\n\nfloat sdHexPrism( vec3 p, vec2 h ) {\n    vec3 q = abs(p);\n    return max(q.z-h.y,max((q.x*0.866025+q.y*0.5),q.y)-h.x);\n}\n\nfloat map( in vec3 p ) {\n    float d = GLOBAL_VAR_FAR_2281831123;\n\n    mat4 palmData = GLOBAL_VAR_data_2281831123[0];\n    vec3 scale = vec3(palmData[0][3], palmData[1][3], palmData[2][3]);\n\n    palmData[0][3] = 0.0;\n    palmData[1][3] = 0.0;\n    palmData[2][3] = 0.0;\n\n    d = min(d, sdHexPrism((palmData * vec4(p, 1.0)).xyz, vec2(scale.x, scale.z / 2.0)));\n\n    for( int i = 1; i < 16; i++ ) {\n        d = min(d, sdFingerBone(p, GLOBAL_VAR_data_2281831123[i]));\n    }\n\n    return d;\n}\n\nvec3 calcNormal( in vec3 pos )\n{\n  vec3 eps = vec3(0.02,0.0,0.0);\n\n  return normalize( vec3(\n    map(pos+eps.xyy) - map(pos-eps.xyy),\n    map(pos+eps.yxy) - map(pos-eps.yxy),\n    map(pos+eps.yyx) - map(pos-eps.yyx) ) );\n}\n\nfloat hash( float v ) { return fract( sin(v) * 12.419821); }\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n\n    vec2 uv = gl_FragCoord.xy / resolution.xy;\n\n    vec4 positionInfo = texture2D( texturePosition, uv );\n    vec3 position = positionInfo.xyz;\n    vec3 velocity = texture2D( textureVelocity, uv ).xyz;\n\n    float d = map(position);\n\n    if(positionInfo.w < 0.005) {\n\n        d = FAR;\n        velocity = vec3( 0.0, random(uv) * 1.0, 0.0 );\n\n    } else {\n\n        if(position.y < 0.0) {\n            float groundBounceRatio =  random(position.xz);\n            velocity.y *= -0.5 * groundBounceRatio;\n            velocity.xz *= 0.5 * groundBounceRatio;\n\n            // add some fake physics on the floor to make it looks better when\n            // the hand is not blocking the particles\n            float strength = length(velocity) * pow(positionInfo.w, 3.0);\n            velocity.x += (random(uv + 0.1) - 0.5) *strength;\n            velocity.z += (random(uv + 0.4) - 0.5) *strength;\n        } else {\n            velocity.y -= (0.03 - 0.005 * random(uv + 5.0)) * gravity;\n        }\n\n        float velocityDistance = length(velocity);\n        d = map(position);\n        if(d < velocityDistance) {\n\n            if(d > INTERSECTION_PRECISION) {\n                // raymarch\n                vec3 rd = normalize(velocity);\n                position = position + rd * d;\n\n                float dd = 0.0;\n                for( int i = 0; i < 10; i++ ) {\n                    dd = map( position);\n                    if(dd < INTERSECTION_PRECISION || d > FAR) break;\n                    d += dd;\n                    position += rd * dd;\n                }\n\n            }\n            vec3 normal = calcNormal(position);\n\n            velocity = reflect(velocity, normal) * handBounceRatio;\n            vec3 palmDirection = normalize(palmVelocity);\n            velocity += palmVelocity * handForce * max(dot(palmDirection, normal), 0.0);\n\n        }\n    }\n\n    gl_FragColor = vec4(velocity, d );\n\n}\n"),transparent:!1,depthWrite:!1,depthTest:!1}),h=new M.ShaderMaterial({uniforms:{resolution:{type:"v2",value:new M.Vector2(w.simulatorTextureWidth,w.simulatorTextureHeight)},texturePosition:{type:"t",value:null},textureVelocity:{type:"t",value:null},textureVelocity2:{type:"t",value:null},dropRadius:{type:"f",value:w.particlesDropRadius},fromY:{type:"f",value:w.particlesFromY},yDynamicRange:{type:"f",value:w.particlesYDynamicRange},data:{type:"m4v",value:x}},defines:{HAND_AMOUNT:w.hands,MATRIX_AMOUNT:16*w.hands},vertexShader:E("#define GLSLIFY 1\nvoid main() {\n    gl_Position = vec4( position, 1.0 );\n}\n"),
fragmentShader:E("#define GLSLIFY 1\nuniform vec2 resolution;\n\nuniform sampler2D textureVelocity2;\nuniform sampler2D textureVelocity;\nuniform sampler2D texturePosition;\nuniform mat4 data[16];\n\nuniform float dropRadius;\nuniform float fromY;\nuniform float yDynamicRange;\n\nconst float INTERSECTION_PRECISION = 1.0;\nconst float FAR = 2000.0;\nconst float PI_2 = 6.2831853072;\n\nfloat sdSphere( vec3 p, float s ) {\n  return length(p)-s;\n}\n\nfloat sdCappedCylinderLower( vec3 p, vec2 h ){\n  vec2 d = abs(vec2(length(p.xz),p.y + h.y)) - h;\n  return min(max(d.x,d.y),0.0) + length(max(d,0.0));\n}\n\nfloat sdFingerBone( in vec3 p, in mat4 fingerBone) {\n\n    vec3 scale = vec3(fingerBone[0][3], fingerBone[1][3], fingerBone[2][3]);\n\n    fingerBone[0][3] = 0.0;\n    fingerBone[1][3] = 0.0;\n    fingerBone[2][3] = 0.0;\n\n    p = (fingerBone * vec4(p, 1.0)).xyz;\n\n    return min(\n        sdSphere(p, scale.x),\n        sdCappedCylinderLower(p, vec2(scale.x, scale.y / 2.0))\n    );\n}\n\nfloat sdHexPrism( vec3 p, vec2 h ) {\n    vec3 q = abs(p);\n    return max(q.z-h.y,max((q.x*0.866025+q.y*0.5),q.y)-h.x);\n}\n\nfloat map( in vec3 p ) {\n    float d = GLOBAL_VAR_FAR_2281831123;\n\n    mat4 palmData = GLOBAL_VAR_data_2281831123[0];\n    vec3 scale = vec3(palmData[0][3], palmData[1][3], palmData[2][3]);\n\n    palmData[0][3] = 0.0;\n    palmData[1][3] = 0.0;\n    palmData[2][3] = 0.0;\n\n    d = min(d, sdHexPrism((palmData * vec4(p, 1.0)).xyz, vec2(scale.x, scale.z / 2.0)));\n\n    for( int i = 1; i < 16; i++ ) {\n        d = min(d, sdFingerBone(p, GLOBAL_VAR_data_2281831123[i]));\n    }\n\n    return d;\n}\n\nvec3 calcNormal( in vec3 pos )\n{\n  vec3 eps = vec3(0.02,0.0,0.0);\n\n  return normalize( vec3(\n    map(pos+eps.xyy) - map(pos-eps.xyy),\n    map(pos+eps.yxy) - map(pos-eps.yxy),\n    map(pos+eps.yyx) - map(pos-eps.yyx) ) );\n}\n\nfloat hash( float v ) { return fract( sin(v) * 12.419821); }\n\nhighp float random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt= dot(co.xy ,vec2(a,b));\n    highp float sn= mod(dt,3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n\n    vec2 uv = gl_FragCoord.xy / resolution.xy;\n\n    vec4 positionInfo = texture2D( texturePosition, uv );\n    vec3 position = positionInfo.xyz;\n    vec3 prevVelocity = texture2D( textureVelocity2, uv ).xyz;\n    vec4 velocityInfo = texture2D( textureVelocity, uv );\n    vec3 velocity = velocityInfo.xyz;\n\n    float d = velocityInfo.w;\n\n    positionInfo.w -= 0.01;\n\n    if(positionInfo.w < 0.0) {\n\n        positionInfo.w = 1.0 + random(uv + 2.0);\n        float a = hash(uv.x) * PI_2;\n        float r = pow(hash(uv.y), 0.75) * dropRadius;\n        position = vec3( cos(a) * r, fromY + random(uv + 1.0) * yDynamicRange, sin(a) * r );\n\n    } else {\n\n        float velocityDistance = length(prevVelocity);\n        if(d < velocityDistance) {\n\n            if(d > INTERSECTION_PRECISION) {\n                // raymarch\n                vec3 rd = normalize(prevVelocity);\n                position = position + rd * d;\n\n                float dd = 0.0;\n                for( int i = 0; i < 10; i++ ) {\n                    dd = map( position);\n                    if(dd < INTERSECTION_PRECISION || d > FAR) break;\n                    d += dd;\n                    position += rd * dd;\n                }\n\n            }\n            vec3 normal = calcNormal(position);\n\n            if(d < 0.0) {\n                position += normal * (-d + INTERSECTION_PRECISION);\n            }\n\n        }\n\n        position += velocity;\n    }\n\n    gl_FragColor = vec4(position, positionInfo.w);\n\n}\n"),transparent:!1,depthWrite:!1,depthTest:!1}),_=new M.Mesh(new M.PlaneBufferGeometry(2,2),c),b.add(_),p=new M.WebGLRenderTarget(w.simulatorTextureWidth,w.simulatorTextureHeight,{wrapS:M.RepeatWrapping,wrapT:M.RepeatWrapping,minFilter:M.NearestFilter,magFilter:M.NearestFilter,format:M.RGBAFormat,type:M.FloatType,depthBuffer:!1,stencilBuffer:!1}),f=p.clone(),a(s(),p),a(p,f),m=new M.WebGLRenderTarget(w.simulatorTextureWidth,w.simulatorTextureHeight,{wrapS:M.RepeatWrapping,wrapT:M.RepeatWrapping,minFilter:M.NearestFilter,magFilter:M.NearestFilter,format:M.RGBAFormat,type:M.FloatType,depthBuffer:!1,stencilBuffer:!1}),v=m.clone(),a(u(),m),a(m,v)}function r(t){var e=p;p=f,f=e,_.material=d,d.uniforms.textureVelocity.value=f,d.uniforms.texturePosition.value=m,g.render(b,y,p)}function o(t){var e=m;m=v,v=e,_.material=h,h.uniforms.texturePosition.value=v,h.uniforms.textureVelocity.value=p,h.uniforms.textureVelocity2.value=f,g.render(b,y,m)}function a(t,e){_.material=c,c.uniforms.texture.value=t,g.render(b,y,e)}function s(){for(var t=new Float32Array(4*S),e=0,n=t.length;e<n;e+=4)t[e+0]=0,t[e+1]=10*-Math.random(),t[e+2]=0;var i=new M.DataTexture(t,w.simulatorTextureWidth,w.simulatorTextureHeight,M.RGBAFormat,M.FloatType);return i.minFilter=M.NearestFilter,i.magFilter=M.NearestFilter,i.needsUpdate=!0,i.flipY=!1,i}function u(){for(var t,e,n=new Float32Array(4*S),i=w.particlesDropRadius,r=w.particlesFromY,o=w.particlesYDynamicRange,a=0,s=n.length;a<s;a+=4)e=Math.random()*Math.PI,t=Math.pow(Math.random(),.75)*i,n[a+0]=Math.cos(e)*t,n[a+1]=r+Math.random()*o,n[a+2]=Math.sin(e)*t,n[a+3]=.5+Math.random();var u=new M.DataTexture(n,w.simulatorTextureWidth,w.simulatorTextureHeight,M.RGBAFormat,M.FloatType);return u.minFilter=M.NearestFilter,u.magFilter=M.NearestFilter,u.needsUpdate=!0,u.generateMipmaps=!1,u.flipY=!1,u}function l(t){h.uniforms.dropRadius.value=w.particlesDropRadius,h.uniforms.fromY.value=w.particlesFromY,h.uniforms.yDynamicRange.value=w.particlesYDynamicRange,d.uniforms.handBounceRatio.value=w.handBounceRatio,d.uniforms.handForce.value=w.handForce,d.uniforms.gravity.value=w.gravity,r(t),o(t),n.positionRenderTarget=m,n.prevPositionRenderTarget=v}var c,d,h,p,f,m,v,g,_,b,y,x,w=t(60),M=t(33),E=t(41),S=n.AMOUNT=w.simulatorTextureWidth*w.simulatorTextureHeight;n.init=i,n.update=l,n.positionRenderTarget=void 0,n.prevPositionRenderTarget=void 0},{33:33,41:41,60:60}],47:[function(t,e,n){function i(t){c||(c=t,m=n.rawShaderPrefix="precision "+c.capabilities.precision+" float;\n",h=new f.Scene,p=new f.Camera,p.position.z=1,g=n.copyMaterial=new f.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:l}},vertexShader:v=n.vertexShader=m+"#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = uv;\n    gl_Position = vec4( position, 1.0 );\n}\n",fragmentShader:m+"#define GLSLIFY 1\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D( u_texture, v_uv );\n}\n"}),d=new f.Mesh(new f.PlaneBufferGeometry(2,2),g),h.add(d))}function r(t,e){d.material=g,g.uniforms.u_texture.value=t,e?c.render(h,p,e):c.render(h,p)}function o(t,e){d.material=t,e?c.render(h,p,e):c.render(h,p)}function a(t,e,n,i,r,o){var a=new f.WebGLRenderTarget(t||1,e||1,{format:n||f.RGBFormat,type:i||f.UnsignedByteType,minFilter:r||f.LinearFilter,magFilter:o||f.LinearFilter});return a.texture.generateMipMaps=!1,a}function s(){return{autoClearColor:c.autoClearColor,clearColor:c.getClearColor().getHex(),clearAlpha:c.getClearAlpha()}}function u(t){c.setClearColor(t.clearColor,t.clearAlpha),c.autoClearColor=t.autoClearColor}var l,c,d,h,p,f=t(33),m=n.rawShaderPrefix=l,v=n.vertexShader=l,g=n.copyMaterial=l;n.init=i,n.copy=r,n.render=o,n.createRenderTarget=a,n.getColorState=s,n.setColorState=u},{33:33}],48:[function(t,e,n){e.exports={fingers:[{positions:[[-38.2189,60.9604,64.5924],[-38.2189,60.9604,64.5924],[-1.12559,79.7574,49.932],[12.0741,86.9312,23.8296],[4.75387,83.9228,10.1354]],width:17.887},{positions:[[-51.5461,77.0885,65.4124],[-27.7155,120.936,23.7887],[-8.3735,97.377,1.18308],[-7.1981,76.1218,2.81282],[-9.16495,65.5395,6.96613]],width:17.0857},{positions:[[-60.7616,77.3919,59.6436],[-45.1707,117.62,15.6383],[-18.6337,91.6693,-5.21932],[-13.5415,67.644,.0511352],[-13.9111,56.4441,5.98309]],width:16.7804},{positions:[[-69.2867,74.9599,53.3851],[-62.4294,108.825,10.1692],[-36.1111,86.3636,-8.81518],[-27.4399,64.586,-1.79382],[-25.7971,54.2056,5.14412]],width:15.9676},{positions:[[-75.169,66.8402,45.8014],[-76.0903,97.0578,4.45619],[-52.3843,82.8792,-10.1212],[-42.1453,70.5831,-3.60624],[-37.7832,62.9693,4.02072]],width:14.1837}],palmPosition:[-48.9255,98.0567,26.448],palmVelocity:[-2.16856,-2.66415,-.147639],_pitch:.8568779317864111,_yaw:.23460461915433872,_roll:.6830778953159898,pinky:{positions:[0,[-76.0903,97.0578,4.45619]]},thumb:{positions:[0,[-38.2189,60.9604,64.5924]],width:17.887}}},{}],49:[function(t,e,n){function i(){var t=new r.PlaneGeometry(4e3,4e3,10,10),e=new r.MeshStandardMaterial({roughness:.7,metalness:1,color:3355443,emissive:0}),i=n.mesh=new r.Mesh(t,e);i.rotation.x=-1.57,i.receiveShadow=!0}var r=(t(60),t(33));n.mesh=void 0,n.init=i},{33:33,60:60}],50:[function(t,e,n){function i(){u=n.mesh=new a.Object3D,u.position.y=150;var t=new a.AmbientLight(6710886);u.add(t),l=n.pointLight=new a.PointLight(13421772,1,800),l.castShadow=!0,l.shadow.camera.near=10,l.shadow.camera.far=800,l.shadow.bias=.01,l.shadow.mapWidth=2048,l.shadow.mapHeight=1024,u.add(l);var e=new a.DirectionalLight(11184810,.5);e.position.set(1,1,1),u.add(e);var i=new a.DirectionalLight(10066329,.3);i.position.set(1,1,-1),u.add(i);var r=new a.PlaneGeometry(100,100),o=new a.ShaderMaterial({uniforms:{},vertexShader:s("#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n\n    vUv = uv;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"),fragmentShader:s("#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    float d = max(1.0 - length(vUv - 0.5) * 2.0, 0.0);\n    gl_FragColor = vec4(mix(vec3(0.73, 0.55, 0.55), vec3(1.0), d) * d, d );\n}\n"),transparent:!0,blending:a.AdditiveBlending,depthTest:!0,depthWrite:!1});c=new a.Mesh(r,o),l.add(c)}function r(t,e){d+=t*o.lightSpeed;var n=5e-4*d-.2;l.position.x=100*Math.cos(n),l.position.z=300*Math.sin(n),c.lookAt(e.position)}var o=t(60),a=t(33),s=t(41),u=n.mesh=void 0,l=n.pointLight=void 0;n.init=i,n.update=r;var c,d=0},{33:33,41:41,60:60}],51:[function(t,e,n){function i(t,e){c.init(t,e),r(),o(),f=u.useBillboardParticle?n.mesh=new l.Mesh(m,v):n.mesh=new l.Points(m,v),f.castShadow=!0,f.receiveShadow=!0,f.customDistanceMaterial=g,f.motionMaterial=_}function r(){var t=u.simulatorTextureWidth,e=u.simulatorTextureHeight,n=c.AMOUNT;m=new l.BufferGeometry;var i,r,o;if(u.useBillboardParticle){r=new Float32Array(3*n*3),o=new Float32Array(3*n*2);var a=new Float32Array(3*n*3);m.addAttribute("positionFlip",new l.BufferAttribute(a,3));var s,d,h=2*Math.PI/3;for(i=0;i<n;i++)s=6*i,d=9*i,r[d+0]=Math.sin(2*h+Math.PI),r[d+1]=Math.cos(2*h+Math.PI),r[d+3]=Math.sin(h+Math.PI),r[d+4]=Math.cos(h+Math.PI),r[d+6]=Math.sin(3*h+Math.PI),r[d+7]=Math.cos(3*h+Math.PI),a[d+0]=Math.sin(2*h),a[d+1]=Math.cos(2*h),a[d+3]=Math.sin(h),a[d+4]=Math.cos(h),a[d+6]=Math.sin(3*h),a[d+7]=Math.cos(3*h),o[s+0]=o[s+2]=o[s+4]=i%t/e,o[s+1]=o[s+3]=o[s+5]=~~(i/t)/e}else{r=new Float32Array(3*n),o=new Float32Array(2*n);var p;for(i=0;i<n;i++)p=2*i,o[p+0]=i%t/e,o[p+1]=~~(i/t)/e}m.addAttribute("position",new l.BufferAttribute(r,3)),m.addAttribute("fboUV",new l.BufferAttribute(o,2))}function o(){var t=l.UniformsUtils.merge([l.UniformsLib.common,l.UniformsLib.fog,l.UniformsLib.lights]);v=new l.ShaderMaterial({uniforms:p(t,{texturePosition:{type:"t",value:s},flipRatio:{type:"f",value:0}}),defines:{USE_BILLBOARD:u.useBillboardParticle},vertexShader:d("#define GLSLIFY 1\nattribute vec2 fboUV;\nuniform sampler2D texturePosition;\n\n#ifdef USE_BILLBOARD\n\n    attribute vec3 positionFlip;\n    uniform float flipRatio;\n\n#else\n\n    varying float vAlpha;\n\n#endif\n\n// chunk(shadowmap_pars_vertex);\n\nvoid main() {\n\n    vec4 posInfo = texture2D( texturePosition, fboUV );\n    vec3 pos = posInfo.xyz;\n\n    vec4 worldPosition = modelMatrix * vec4( pos, 1.0 );\n    vec4 mvPosition = viewMatrix * worldPosition;\n\n    #ifdef USE_BILLBOARD\n\n        vec4 flipOffset = vec4(mix(position, positionFlip, flipRatio) * 0.5, 1.0);\n        worldPosition += flipOffset;\n\n    #else\n        gl_PointSize = ( 500.0 / length( mvPosition.xyz ) );\n        mvPosition.y += gl_PointSize * 0.5;\n\n    #endif\n\n    // chunk(shadowmap_vertex);\n\n    #ifdef USE_BILLBOARD\n\n        gl_Position = projectionMatrix * (mvPosition + flipOffset);\n\n    #else\n\n        vAlpha = smoothstep(0.0, 0.1, posInfo.w);\n        gl_Position = projectionMatrix * mvPosition;\n\n    #endif\n\n}\n"),fragmentShader:d("#define GLSLIFY 1\n// chunk(common);\n// chunk(packing);\n// chunk(bsdfs);\n// chunk(lights_pars);\n// chunk(fog_pars_fragment);\n// chunk(shadowmap_pars_fragment);\n// chunk(shadowmask_pars_fragment);\n\n#ifdef USE_BILLBOARD\n\n#else\n\n    varying float vAlpha;\n\n#endif\n\nvoid main() {\n\n    vec3 outgoingLight = vec3(1.0);\n\n    outgoingLight *= 0.1 + pow(0.7 + vec3(getShadowMask()) * 0.3, vec3(1.5)) * 0.9;\n    // chunk(fog_fragment);\n\n    #ifdef USE_BILLBOARD\n\n        gl_FragColor = vec4( outgoingLight, 1.0 );\n\n    #else\n\n        float d = length(gl_PointCoord.xy - .5) * 2.0;\n\n        gl_FragColor = vec4( outgoingLight, vAlpha ) * (1.0 - step(1.0, d)) ;\n\n    #endif\n}\n"),transparent:!u.useBillboardParticle,blending:u.useBillboardParticle?l.NoBlending:l.NormalBlending,depthTest:!0,depthWrite:!0,fog:!0,lights:!0}),g=new l.ShaderMaterial({uniforms:{lightPos:{type:"v3",value:new l.Vector3(0,0,0)},texturePosition:{type:"t",value:s},flipRatio:{type:"f",value:0}},defines:{USE_BILLBOARD:u.useBillboardParticle},vertexShader:d("#define GLSLIFY 1\nattribute vec2 fboUV;\n\nuniform sampler2D texturePosition;\n\n#ifdef USE_BILLBOARD\n\n    attribute vec3 positionFlip;\n    uniform float flipRatio;\n\n#endif\n\nvarying vec4 vWorldPosition;\n\nvoid main() {\n\n    vec3 pos = texture2D( texturePosition, fboUV ).xyz;\n\n    vec4 worldPosition = modelMatrix * vec4( pos, 1.0 );\n    vec4 mvPosition = viewMatrix * worldPosition;\n\n    #ifdef USE_BILLBOARD\n\n        vec4 flipOffset = vec4(mix(position, positionFlip, flipRatio) * 0.5, 1.0);\n        gl_Position = projectionMatrix * (mvPosition + flipOffset);\n\n    #else\n\n        gl_PointSize = ( 300.0 / length( mvPosition.xyz ) );\n        mvPosition.y += gl_PointSize* 0.5;\n        gl_Position = projectionMatrix * mvPosition;\n\n    #endif\n\n    vWorldPosition = worldPosition;\n\n}\n"),fragmentShader:d("#define GLSLIFY 1\nuniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n\nvec4 pack1K ( float depth ) {\n\n   depth /= 1000.0;\n   const vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n   const vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n   vec4 res = fract( depth * bitSh );\n   res -= res.xxyz * bitMsk;\n   return res;\n\n}\n\nfloat unpack1K ( vec4 color ) {\n\n   const vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n   return dot( color, bitSh ) * 1000.0;\n\n}\n\nvoid main () {\n\n   gl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n\n}\n"),depthTest:!0,depthWrite:!0,side:l.BackSide}),_=new h({motionMultiplier:.1,uniforms:{texturePosition:{type:"t",value:s},texturePrevPosition:{type:"t",value:s},flipRatio:{type:"f",value:0}},defines:{USE_BILLBOARD:u.useBillboardParticle},vertexShader:d("#define GLSLIFY 1\nattribute vec2 fboUV;\n\nuniform sampler2D texturePosition;\nuniform sampler2D texturePrevPosition;\n\nuniform mat4 u_prevModelViewMatrix;\nvarying vec2 v_motion;\n\n#ifdef USE_BILLBOARD\n\n    attribute vec3 positionFlip;\n    uniform float flipRatio;\n\n#endif\n\nvoid main() {\n\n    vec4 positionInfo = texture2D( texturePosition, fboUV );\n    vec4 prevPositionInfo = texture2D( texturePrevPosition, fboUV );\n\n    vec4 pos = modelViewMatrix * vec4( positionInfo.xyz, 1.0 );\n    vec4 prevPos = u_prevModelViewMatrix * vec4( prevPositionInfo.xyz, 1.0 );\n\n    #ifdef USE_BILLBOARD\n\n        vec4 flipOffset = vec4(mix(position, positionFlip, flipRatio) * 0.5, 1.0);\n        pos = projectionMatrix * (pos + flipOffset);\n        prevPos = projectionMatrix * (prevPos + flipOffset);\n\n    #else\n\n        gl_PointSize = ( 300.0 / length( pos.xyz ) );\n        pos.y += gl_PointSize* 0.5;\n        pos = projectionMatrix * pos;\n\n        prevPos.y += ( 300.0 / length( prevPos.xyz ) )* 0.5;\n        prevPos = projectionMatrix * prevPos;\n\n    #endif\n\n    gl_Position = pos;\n    v_motion = (pos.xy / pos.w - prevPos.xy / prevPos.w) * 0.5 * step(positionInfo.w, prevPositionInfo.w);\n\n}\n"),depthTest:!0,depthWrite:!0,side:l.BackSide})}function a(){c.update(0),f.material.uniforms.texturePosition.value=c.positionRenderTarget,f.customDistanceMaterial.uniforms.texturePosition.value=c.positionRenderTarget,f.motionMaterial.uniforms.texturePosition.value=c.positionRenderTarget,f.motionMaterial.uniforms.texturePrevPosition.value=c.prevPositionRenderTarget,u.useBillboardParticle&&(f.material.uniforms.flipRatio.value^=1,f.customDistanceMaterial.uniforms.flipRatio.value^=1,f.motionMaterial.uniforms.flipRatio.value^=1)}var s,u=t(60),l=t(33),c=t(46),d=t(41),h=t(56),p=t(22),f=n.mesh=s;n.init=i,n.update=a;var m,v,g,_},{22:22,33:33,41:41,46:46,56:56,60:60}],52:[function(t,e,n){function i(){}function r(t){d(this,{uniforms:{u_texture:{type:"t",value:s},u_resolution:{type:"v2",value:l.resolution},u_aspect:{type:"f",value:1}},enabled:!0,vertexShader:"",fragmentShader:"",isRawMaterial:!0,addRawShaderPrefix:!0},t),this.vertexShader||(this.vertexShader=this.isRawMaterial?c.vertexShader:p),this.addRawShaderPrefix&&this.isRawMaterial&&(this.vertexShader=c.rawShaderPrefix+this.vertexShader,this.fragmentShader=c.rawShaderPrefix+this.fragmentShader),this.material=new u[this.isRawMaterial?"RawShaderMaterial":"ShaderMaterial"]({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader})}function o(t,e){}function a(t,e,n){return this.uniforms.u_texture.value=e,this.uniforms.u_aspect.value=this.uniforms.u_resolution.value.x/this.uniforms.u_resolution.value.y,l.render(this.material,n)}var s,u=t(33),l=t(54),c=t(47),d=t(21);e.exports=i;var h=i.prototype;h.init=r,h.resize=o,h.render=a;var p="#define GLSLIFY 1\nvarying vec2 v_uv;\n\nvoid main() {\n    v_uv = uv;\n    gl_Position = vec4( position, 1.0 );\n}\n"},{21:21,33:33,47:47,54:54}],53:[function(t,e,n){function i(){c.init.call(this,{uniforms:{u_blurTexture:{type:"t",value:o},u_amount:{type:"f",value:0}},fragmentShader:"#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform sampler2D u_blurTexture;\n\nuniform float u_amount;\n\nvarying vec2 v_uv;\n\nvoid main()\n{\n\n    vec3 baseColor = texture2D(u_texture, v_uv).rgb;\n    vec3 blurColor = texture2D(u_blurTexture, v_uv).rgb;\n    vec3 color = mix(baseColor, 1.0 - ((1.0 - baseColor) * (1.0 - blurColor)), u_amount);\n    // vec3 color = mix(baseColor, max(baseColor, blurColor), u_amount);\n\n    gl_FragColor = vec4(color, 1.0);\n\n}\n"}),d=new l.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:o},u_delta:{type:"v2",value:new l.Vector2}},vertexShader:u.vertexShader,fragmentShader:u.rawShaderPrefix+"#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec2 u_delta;\n\nvarying vec2 v_uv;\n\nvoid main()\n{\n\n    vec3 color = texture2D( u_texture, v_uv ).rgb * 0.1633;\n\n    vec2 delta = u_delta;\n    color += texture2D( u_texture,  v_uv - delta ).rgb * 0.1531;\n    color += texture2D( u_texture,  v_uv + delta ).rgb * 0.1531;\n\n    delta += u_delta;\n    color += texture2D( u_texture,  v_uv - delta ).rgb * 0.12245;\n    color += texture2D( u_texture,  v_uv + delta ).rgb * 0.12245;\n\n    delta += u_delta;\n    color += texture2D( u_texture,  v_uv - delta ).rgb * 0.0918;\n    color += texture2D( u_texture,  v_uv + delta ).rgb * 0.0918;\n\n    delta += u_delta;\n    color += texture2D( u_texture,  v_uv - delta ).rgb * 0.051;\n    color += texture2D( u_texture,  v_uv + delta ).rgb * 0.051;\n\n    gl_FragColor = vec4(color, 1.0);\n\n}\n"})}function r(t,e,i){var r=s.getRenderTarget(h),o=s.getRenderTarget(h);s.releaseRenderTarget(r,o);var a=n.blurRadius;d.uniforms.u_texture.value=e,d.uniforms.u_delta.value.set(a/s.resolution.x,0),u.render(d,r),a=n.blurRadius,d.uniforms.u_texture.value=r,d.uniforms.u_delta.value.set(0,a/s.resolution.y),u.render(d,o),this.uniforms.u_blurTexture.value=o,this.uniforms.u_amount.value=n.amount,c.render.call(this,t,e,i)}var o,a=t(52),s=t(54),u=t(47),l=t(33),n=e.exports=new a,c=a.prototype;n.init=i,n.render=r,n.blurRadius=1,n.amount=.3;var d,h=1},{33:33,47:47,52:52,54:54}],54:[function(t,e,n){function i(t,e,i){_=n.fromRenderTarget=m.createRenderTarget(),b=n.toRenderTarget=m.createRenderTarget(),y=n.resolution=new f.Vector2,n.renderer=t,n.scene=e,n.camera=i}function r(t,e){y.set(t,e),_.setSize(t,e),b.setSize(t,e),n.camera.aspect=t/e,n.camera.updateProjectionMatrix(),n.renderer.setSize(t,e);for(var i=0,r=g.length;i<r;i++)g[i].resize(t,e)}function o(t){return t.enabled}function a(t){var e=g.filter(o);if(e.length){b.depthBuffer=!0,b.stencilBuffer=!0,n.renderer.render(n.scene,n.camera,b),l();for(var i,r=0,a=e.length;r<a;r++)i=e[r],i.render(t,_,r===a-1)}else n.renderer.render(n.scene,n.camera)}function s(t,e,i){e=e||n.scene,i=i||n.camera,t?n.renderer.render(e,i,t):n.renderer.render(e,i)}function u(t,e){return m.render(t,e?p:b),l(),_}function l(){var t=b;b=n.toRenderTarget=_,_=n.fromRenderTarget=t}function c(t,e){t=t||0,e=+(e||0);var n,i=y.x>>t,r=y.y>>t,o=t+"_"+e,a=h(o);return a.length?(n=a.pop(),v(n,M)):(n=m.createRenderTarget(i,r,e?f.RGBAFormat:f.RGBFormat),n._listId=o,w[o]=w[o]||0),w[o]++,n.width===i&&n.height===r||n.setSize(i,r),n}function d(t){for(var e,n,i,r,o,a=arguments,s=0,u=a.length;s<u;s++){for(t=a[s],r=t._listId,o=h(r),e=!1,w[r]--,n=0,i=o.length;n<i;n++)if(o[n]===t){e=!0;break}e||o.push(t)}}function h(t){return x[t]||(x[t]=[])}var p,f=t(33),m=t(47),v=t(21);n.init=i,n.resize=r,n.renderQueue=a,n.renderScene=s,n.render=u,n.swapRenderTarget=l,n.getRenderTarget=c,n.releaseRenderTarget=d,n.resolution=p;var g=n.queue=[],_=n.fromRenderTarget=p,b=n.toRenderTarget=p,y=n.resolution=p,x={},w={},M={depthBuffer:!1,texture:{generateMipmaps:!1}};n.renderer=p,n.scene=p,n.camera=p},{21:21,33:33,47:47}],55:[function(t,e,n){function i(t){
var e=t?"#define GLSLIFY 1\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_uv;\n\n//To save 9 dependent texture reads, you can compute\n//these in the vertex shader and use the optimized\n//frag.glsl function in your frag shader. \n\n//This is best suited for mobile devices, like iOS.\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n\t\t\tout vec2 v_rgbNW, out vec2 v_rgbNE,\n\t\t\tout vec2 v_rgbSW, out vec2 v_rgbSE,\n\t\t\tout vec2 v_rgbM) {\n\tvec2 inverseVP = 1.0 / resolution.xy;\n\tv_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n\tv_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n\tv_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n\tv_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n\tv_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main() {\n\n   vec2 fragCoord = uv * u_resolution;\n   texcoords(fragCoord, u_resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n    v_uv = uv;\n    gl_Position = vec4( position, 1.0 );\n\n}\n":"",n=t?'#define GLSLIFY 1\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform vec2 u_resolution;\nuniform sampler2D u_texture;\n\nvarying vec2 v_uv;\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent \n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE, \n            vec2 v_rgbSW, vec2 v_rgbSE, \n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n    vec2 fragCoord = v_uv * u_resolution;\n\n    gl_FragColor = fxaa(u_texture, fragCoord, u_resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n':'#define GLSLIFY 1\nuniform vec2 u_resolution;\nuniform sampler2D u_texture;\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent \n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE, \n            vec2 v_rgbSW, vec2 v_rgbSE, \n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n    \n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n    \n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    \n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n    \n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n//To save 9 dependent texture reads, you can compute\n//these in the vertex shader and use the optimized\n//frag.glsl function in your frag shader. \n\n//This is best suited for mobile devices, like iOS.\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n\t\t\tout vec2 v_rgbNW, out vec2 v_rgbNE,\n\t\t\tout vec2 v_rgbSW, out vec2 v_rgbSE,\n\t\t\tout vec2 v_rgbM) {\n\tvec2 inverseVP = 1.0 / resolution.xy;\n\tv_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n\tv_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n\tv_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n\tv_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n\tv_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvec4 apply(sampler2D tex, vec2 fragCoord, vec2 resolution) {\n\tmediump vec2 v_rgbNW;\n\tmediump vec2 v_rgbNE;\n\tmediump vec2 v_rgbSW;\n\tmediump vec2 v_rgbSE;\n\tmediump vec2 v_rgbM;\n\n\t//compute the texture coords\n\ttexcoords(fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\t\n\t//compute FXAA\n\treturn fxaa(tex, fragCoord, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n\nvoid main() {\n    gl_FragColor = apply(u_texture, gl_FragCoord.xy, u_resolution);\n}\n';o.init.call(this,{uniforms:{},vertexShader:e,fragmentShader:n})}var r=t(52);e.exports=new r;var o=r.prototype;e.exports.init=i},{52:52}],56:[function(t,e,n){function i(t){t=t||{};var e=t.uniforms||{},n=s("#define GLSLIFY 1\n// chunk(morphtarget_pars_vertex);\n// chunk(skinning_pars_vertex);\n\nuniform mat4 u_prevModelViewMatrix;\n\nvarying vec2 v_motion;\n\nvoid main() {\n\n    // chunk(skinbase_vertex);\n    // chunk(begin_vertex);\n\n    // chunk(morphtarget_vertex);\n    // chunk(skinning_vertex);\n\n    vec4 pos = projectionMatrix * modelViewMatrix * vec4( transformed, 1.0 );\n    vec4 prevPos = projectionMatrix * u_prevModelViewMatrix * vec4( transformed, 1.0 );\n    gl_Position = pos;\n    v_motion = (pos.xy / pos.w - prevPos.xy / prevPos.w) * 0.5;\n\n}\n"),i=s("#define GLSLIFY 1\nuniform float u_motionMultiplier;\n\nvarying vec2 v_motion;\n\nvoid main() {\n\n        gl_FragColor = vec4( v_motion * u_motionMultiplier, gl_FragCoord.z, 1.0 );\n\n}\n");this.motionMultiplier=t.motionMultiplier||1,r.ShaderMaterial.call(this,o({uniforms:a(e,{u_prevModelViewMatrix:{type:"m4",value:new r.Matrix4},u_motionMultiplier:{type:"f",value:1}}),vertexShader:n,fragmentShader:i},t))}var r=t(33),o=t(22),a=t(16),s=t(41);(i.prototype=Object.create(r.ShaderMaterial.prototype)).constructor=i,e.exports=i},{16:16,22:22,33:33,41:41}],57:[function(t,e,n){function i(t){var e=d.renderer.getContext();e.getExtension("OES_texture_float")&&e.getExtension("OES_texture_float_linear")||alert("no float linear support"),m=h.createRenderTarget(1,1,p.RGBAFormat,p.FloatType),m.depthBuffer=!0,v=h.createRenderTarget(1,1,p.RGBAFormat,p.FloatType),_=new p.Camera,_.position.z=1,b=new p.Scene,f.init.call(this,{uniforms:{u_lineAlphaMultiplier:{type:"f",value:1},u_linesTexture:{type:"t",value:v}},fragmentShader:"#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform sampler2D u_linesTexture;\nuniform float u_lineAlphaMultiplier;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\n    vec3 base = texture2D( u_texture, v_uv.xy ).rgb;\n    vec4 lines = texture2D( u_linesTexture, v_uv.xy );\n\n    vec3 color = (base + lines.rgb * u_lineAlphaMultiplier) / (lines.a * u_lineAlphaMultiplier + 1.0);\n\n    gl_FragColor = vec4( color, 1.0 );\n\n}\n"}),y=[],w=new p.BufferGeometry,M=new p.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:l},u_motionTexture:{type:"t",value:m},u_resolution:{type:"v2",value:d.resolution},u_maxDistance:{type:"f",value:1},u_jitter:{type:"f",value:.3},u_fadeStrength:{type:"f",value:1},u_motionMultiplier:{type:"f",value:1},u_depthTest:{type:"f",value:0},u_opacity:{type:"f",value:1},u_leaning:{type:"f",value:.5},u_depthBias:{type:"f",value:.01}},vertexShader:h.rawShaderPrefix+"#define GLSLIFY 1\nattribute vec3 position;\n\nuniform sampler2D u_texture;\nuniform sampler2D u_motionTexture;\n\nuniform vec2 u_resolution;\nuniform float u_maxDistance;\nuniform float u_jitter;\nuniform float u_motionMultiplier;\nuniform float u_leaning;\n\nvarying vec3 v_color;\nvarying float v_ratio;\nvarying float v_depth;\nvarying vec2 v_uv;\n\nvoid main() {\n\n    v_color = texture2D( u_texture, position.xy ).rgb;\n\n    float side = step(0.001, position.z);\n\n    v_ratio = side;\n\n    vec3 motion = texture2D( u_motionTexture, position.xy ).xyz;\n    v_depth = motion.z;\n\n    vec2 offset = motion.xy * u_resolution * u_motionMultiplier;\n    float offsetDistance = length(offset);\n    if(offsetDistance > u_maxDistance) {\n        offset = normalize(offset) * u_maxDistance;\n    }\n\n    vec2 pos = position.xy * 2.0 - 1.0 - offset / u_resolution * 2.0 * (1.0 - position.z * u_jitter) * (side - u_leaning);\n    v_uv = pos * 0.5 + 0.5;\n\n    gl_Position = vec4( pos, 0.0, 1.0 );\n\n}\n",fragmentShader:h.rawShaderPrefix+"#define GLSLIFY 1\nuniform sampler2D u_motionTexture;\nuniform float u_depthTest;\nuniform float u_opacity;\nuniform float u_leaning;\nuniform float u_fadeStrength;\nuniform float u_depthBias;\nuniform float u_useDepthWeight;\n\nvarying vec3 v_color;\nvarying float v_ratio;\nvarying float v_depth;\nvarying vec2 v_uv;\n\nvoid main() {\n\n    vec3 motion = texture2D( u_motionTexture, v_uv ).xyz;\n\n    float alpha = smoothstep(0.0, u_leaning, v_ratio) * (1.0 - smoothstep (u_leaning, 1.0, v_ratio));\n\n    alpha = pow(alpha, u_fadeStrength) * u_opacity;\n\n    if(alpha < 0.00392157) {\n        discard;\n    }\n\n    float threshold = v_depth * step(0.0001, motion.z);\n    alpha *= max(1.0 - u_depthTest, smoothstep(threshold - u_depthBias, threshold, motion.z));\n\n    gl_FragColor = vec4( v_color * alpha, alpha );\n\n}\n",blending:p.CustomBlending,blendEquation:p.AddEquation,blendSrc:p.OneFactor,blendDst:p.OneFactor,blendEquationAlpha:p.AddEquation,blendSrcAlpha:p.OneFactor,blendDstAlpha:p.OneFactor,depthTest:!1,depthWrite:!1,transparent:!0}),g=new p.LineSegments(w,M),b.add(g),E=new p.RawShaderMaterial({uniforms:{u_texture:{type:"t",value:l},u_motionTexture:{type:"t",value:m},u_resolution:{type:"v2",value:d.resolution},u_maxDistance:{type:"f",value:1},u_fadeStrength:{type:"f",value:1},u_motionMultiplier:{type:"f",value:1},u_leaning:{type:"f",value:.5}},defines:{SAMPLE_COUNT:t||21},vertexShader:this.material.vertexShader,fragmentShader:h.rawShaderPrefix+"#define SAMPLE_COUNT "+(t||21)+"\n#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform sampler2D u_motionTexture;\n\nuniform vec2 u_resolution;\nuniform float u_maxDistance;\nuniform float u_motionMultiplier;\nuniform float u_leaning;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\n    vec2 motion = texture2D( u_motionTexture, v_uv ).xy;\n\n    vec2 offset = motion * u_resolution * u_motionMultiplier;\n    float offsetDistance = length(offset);\n    if(offsetDistance > u_maxDistance) {\n        offset = normalize(offset) * u_maxDistance;\n    }\n    vec2 delta = - offset / u_resolution * 2.0 / float(SAMPLE_COUNT);\n    vec2 pos = v_uv - delta * u_leaning * float(SAMPLE_COUNT);\n    vec3 color = vec3(0.0);\n\n    for(int i = 0; i < SAMPLE_COUNT; i++) {\n        color += texture2D( u_texture, pos ).rgb;\n        pos += delta;\n    }\n\n    gl_FragColor = vec4( color / float(SAMPLE_COUNT), 1.0 );\n\n}\n"})}function r(t,e){t?(R=t,P=e):(t=R,e=P);var i=~~(t*n.motionRenderTargetScale),r=~~(e*n.motionRenderTargetScale);if(m.setSize(i,r),!n.useSampling){var a=~~(t*n.linesRenderTargetScale),s=~~(e*n.linesRenderTargetScale);v.setSize(a,s);var u,l=!n.useDithering,c=l?a*s:o(a,s);c>y.length/6&&(y=new Float32Array(6*c),x=new p.BufferAttribute(y,3),w.removeAttribute("position"),w.addAttribute("position",x));var d,h,f=0,g=a*s;for(u=0;u<g;u++)d=u%a,h=~~(u/a),(l||d+(1&h)&1)&&(y[f+0]=y[f+3]=(d+.5)/a,y[f+1]=y[f+4]=(h+.5)/s,y[f+2]=0,y[f+5]=.001+.999*Math.random(),f+=6);x.needsUpdate=!0,w.drawRange.count=2*c}S=n.useDithering,A=n.useSampling}function o(t,e){return 1&t&&1&e?((t-1)*(e-1)>>1)+(t>>1)+(e>>1):t*e>>1}function a(t,e,i){S!==n.useDithering?r():A!==n.useSampling&&r();var o=n.useSampling,a=1e3/(t<16.667?16.667:t)/n.targetFPS,l=h.getColorState();d.renderer.setClearColor(0,1),d.renderer.clearTarget(m,!0),d.scene.traverseVisible(s),d.renderScene(m);for(var c=0,p=O.length;c<p;c++)u(O[c]);O=[],o||(M.uniforms.u_maxDistance.value=n.maxDistance,M.uniforms.u_jitter.value=n.jitter,M.uniforms.u_fadeStrength.value=n.fadeStrength,M.uniforms.u_motionMultiplier.value=n.motionMultiplier*a,M.uniforms.u_depthTest.value=n.depthTest,M.uniforms.u_opacity.value=n.opacity,M.uniforms.u_leaning.value=Math.max(.001,Math.min(.999,n.leaning)),M.uniforms.u_depthBias.value=Math.max(1e-5,n.depthBias),M.uniforms.u_texture.value=e,d.renderer.setClearColor(0,0),d.renderer.clearTarget(v,!0),d.renderer.render(b,_,v)),h.setColorState(l),o?(E.uniforms.u_maxDistance.value=n.maxDistance,E.uniforms.u_fadeStrength.value=n.fadeStrength,E.uniforms.u_motionMultiplier.value=n.motionMultiplier*a,E.uniforms.u_leaning.value=Math.max(.001,Math.min(.999,n.leaning)),E.uniforms.u_texture.value=e,d.render(E,i)):(this.uniforms.u_lineAlphaMultiplier.value=1+n.useDithering,f.render.call(this,t,e,i))}function s(t){t.motionMaterial?(t._tmpMaterial=t.material,t.material=t.motionMaterial,t.material.uniforms.u_motionMultiplier.value=t.material.motionMultiplier):t.material&&(t.visible=!1),O.push(t)}function u(t){t.motionMaterial?(t.material=t._tmpMaterial,t._tmpMaterial=l,n.skipMatrixUpdate||t.motionMaterial.uniforms.u_prevModelViewMatrix.value.copy(t.modelViewMatrix)):t.visible=!0}var l,c=t(52),d=t(54),h=t(47),p=t(33),n=e.exports=new c,f=c.prototype;n.init=i,n.resize=r,n.render=a,n.useSampling=!1,n.skipMatrixUpdate=!1,n.fadeStrength=1,n.motionMultiplier=1,n.maxDistance=100,n.targetFPS=60,n.leaning=.5,n.jitter=0,n.opacity=1,n.depthBias=.002,n.depthTest=!1,n.useDithering=!1,n.motionRenderTargetScale=1,n.linesRenderTargetScale=.5;var m,v,g,_,b,y,x,w,M,E,S,A,R,P,O=[]},{33:33,47:47,52:52,54:54}],58:[function(t,e,n){function i(t,e,n){h=t,p=e,f=f,a.init(t,e,n),s.init(),a.queue.push(s),c.init(),a.queue.push(c),u.init(),a.queue.push(u),l.init(),a.queue.push(l)}function r(t,e){a.resize(t,e)}function o(t){a.renderQueue(t),n.visualizeTarget&&d.copy(n.visualizeTarget)}var a=t(54),s=t(55),u=t(53),l=t(59),c=t(57),d=t(47);n.init=i,n.resize=r,n.render=o,n.visualizeTarget=void 0;var h,p,f},{47:47,53:53,54:54,55:55,57:57,59:59}],59:[function(t,e,n){function i(){o.init.call(this,{uniforms:{u_reduction:{type:"f",value:.3},u_boost:{type:"f",value:1.2}},fragmentShader:"#define GLSLIFY 1\nuniform sampler2D u_texture;\nuniform vec2 u_resolution;\nuniform float u_aspect;\n\nuniform float u_reduction;\nuniform float u_boost;\n\nvarying vec2 v_uv;\n\nfloat range(float vmin, float vmax, float value) {\n  return (value - vmin) / (vmax - vmin);\n}\n\nvoid main() {\n\n  vec4 color = texture2D( u_texture, v_uv );\n\n  vec2 center = u_resolution * 0.5;\n  float vignette = range(0.25, 1.0, length( v_uv - vec2(0.5) ));\n  vignette = u_boost - vignette * u_reduction;\n\n  color.rgb *= vignette;\n  gl_FragColor = color;\n\n}\n"})}var r=t(52);e.exports=new r;var o=r.prototype;e.exports.init=i},{52:52}],60:[function(t,e,n){var i=t(26),r=t(20),o=n.query=i(window.location.href.replace("#","?"));n.useStats=!1;var a={"4k":[64,64,.29],"8k":[128,64,.42],"16k":[128,128,.48],"32k":[256,128,.55],"65k":[256,256,.6],"131k":[512,256,.85],"252k":[512,512,1.2],"524k":[1024,512,1.4],"1m":[1024,1024,1.6],"2m":[2048,1024,2],"4m":[2048,2048,2.5]};n.amountList=r(a),o.amount=a[o.amount]?o.amount:"65k";var s=a[o.amount];n.simulatorTextureWidth=s[0],n.simulatorTextureHeight=s[1],n.useStats=!1,n.useBillboardParticle=!1,n.lightSpeed=0,n.bloomOpacity=.45,n.particlesDropRadius=20,n.particlesFromY=300,n.particlesYDynamicRange=300,n.handBounceRatio=.1,n.handForce=.015,n.gravity=10,n.fxaa=!1;var u=n.motionBlurQualityMap={best:1,high:.5,medium:1/3,low:.25};n.motionBlurQualityList=r(u),o.motionBlurQuality=u[o.motionBlurQuality]?o.motionBlurQuality:"medium",n.motionBlur=!0,n.motionBlurPause=!1,n.bloom=!1,n.vignette=!1,n.vignetteMultiplier=.8},{20:20,26:26}],61:[function(t,e,n){function i(){return r||(r=new o.MeshStandardMaterial({roughness:.86,metalness:.45,color:11184810,emissive:0})),r}var r,o=(t(60),t(33));n.getMaterial=i},{33:33,60:60}],62:[function(t,e,n){var i=(t(76),t(6)),r=i.vec3,o=i.mat3,a=i.mat4,s=(t(37),e.exports=function(t,e){this.finger=t,this._center=null,this._matrix=null,this.type=e.type,this.prevJoint=e.prevJoint,this.nextJoint=e.nextJoint,this.width=e.width;var n=new Array(3);r.sub(n,e.nextJoint,e.prevJoint),this.length=r.length(n),this.basis=e.basis});s.prototype.left=function(){return this._left?this._left:(this._left=o.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))<0,this._left)},s.prototype.matrix=function(){if(this._matrix)return this._matrix;var t=this.basis,e=this._matrix=a.create();return e[0]=t[0][0],e[1]=t[0][1],e[2]=t[0][2],e[4]=t[1][0],e[5]=t[1][1],e[6]=t[1][2],e[8]=t[2][0],e[9]=t[2][1],e[10]=t[2][2],e[3]=this.center()[0],e[7]=this.center()[1],e[11]=this.center()[2],this.left()&&(e[0]*=-1,e[1]*=-1,e[2]*=-1),this._matrix},s.prototype.lerp=function(t,e){r.lerp(t,this.prevJoint,this.nextJoint,e)},s.prototype.center=function(){if(this._center)return this._center;var t=r.create();return this.lerp(t,.5),this._center=t,t},s.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},{37:37,6:6,76:76}],63:[function(t,e,n){var i=e.exports=function(t){this.pos=0,this._buf=[],this.size=t};i.prototype.get=function(t){if(void 0==t&&(t=0),!(t>=this.size||t>=this._buf.length))return this._buf[(this.pos-t-1)%this.size]},i.prototype.push=function(t){return this._buf[this.pos%this.size]=t,this.pos++}},{}],64:[function(t,e,n){var i=t(77).chooseProtocol,r=t(5).EventEmitter,o=t(37),a=e.exports=function(t){this.opts=o.defaults(t||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:a.defaultProtocolVersion}),this.host=this.opts.host,this.port=this.opts.port,this.scheme=this.opts.scheme,this.protocolVersionVerified=!1,this.background=null,this.optimizeHMD=null,this.on("ready",function(){this.enableGestures(this.opts.enableGestures),this.setBackground(this.opts.background),this.setOptimizeHMD(this.opts.optimizeHMD),this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};a.defaultProtocolVersion=6,a.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"},a.prototype.getScheme=function(){return"ws:"},a.prototype.getPort=function(){return 6437},a.prototype.setBackground=function(t){this.opts.background=t,this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))},a.prototype.setOptimizeHMD=function(t){this.opts.optimizeHMD=t,this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))},a.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))},a.prototype.enableGestures=function(t){this.gesturesEnabled=!!t,this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))},a.prototype.handleClose=function(t,e){this.connected&&(this.disconnect(),1001===t&&this.opts.requestProtocolVersion>1&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())},a.prototype.startReconnection=function(){var t=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){t.reconnect()},500))},a.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)},a.prototype.disconnect=function(t){if(t||this.stopReconnection(),this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0},a.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())},a.prototype.handleData=function(t){var e,n=JSON.parse(t);void 0===this.protocol?(e=this.protocol=i(n),this.protocolVersionVerified=!0,this.emit("ready")):e=this.protocol(n),this.emit(e.type,e)},a.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0},a.prototype.send=function(t){this.socket.send(t)},a.prototype.reportFocus=function(t){this.connected&&this.focusedState!==t&&(this.focusedState=t,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))},o.extend(a.prototype,r.prototype)},{37:37,5:5,77:77}],65:[function(t,e,n){var i=e.exports=t(64),r=t(37),o=e.exports=function(t){i.call(this,t);var e=this;this.on("ready",function(){e.startFocusLoop()}),this.on("disconnect",function(){e.stopFocusLoop()})};r.extend(o.prototype,i.prototype),o.__proto__=i,o.prototype.useSecure=function(){return"https:"===location.protocol},o.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"},o.prototype.getPort=function(){return this.useSecure()?6436:6437},o.prototype.setupSocket=function(){var t=this,e=new WebSocket(this.getUrl());return e.onopen=function(){t.handleOpen()},e.onclose=function(e){t.handleClose(e.code,e.reason)},e.onmessage=function(e){t.handleData(e.data)},e.onerror=function(e){t.useSecure()&&"wss:"===t.scheme&&(t.scheme="ws:",t.port=6437,t.disconnect(),t.connect())},e},o.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var t=this,e=null;e=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0,void 0===t.windowVisible&&(t.windowVisible=void 0===e||!1===document[e]);var n=window.addEventListener("focus",function(e){t.windowVisible=!0,r()}),i=window.addEventListener("blur",function(e){t.windowVisible=!1,r()});this.on("disconnect",function(){window.removeEventListener("focus",n),window.removeEventListener("blur",i)});var r=function(){var n=void 0===e||!1===document[e];t.reportFocus(n&&t.windowVisible)};r(),this.focusDetectorTimer=setInterval(r,100)}},o.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{37:37,64:64}],66:[function(t,e,n){var i=t(38),r=t(64),o=t(37),a=e.exports=function(t){r.call(this,t);var e=this;this.on("ready",function(){e.reportFocus(!0)})};o.extend(a.prototype,r.prototype),a.__proto__=r,a.prototype.setupSocket=function(){var t=this,e=new i(this.getUrl());return e.on("open",function(){t.handleOpen()}),e.on("message",function(e){t.handleData(e)}),e.on("close",function(e,n){t.handleClose(e,n)}),e.on("error",function(){t.startReconnection()}),e}},{37:37,38:38,64:64}],67:[function(t,e,n){(function(n){var i=t(70),r=t(72),o=t(76),a=t(69),s=t(63),u=t(75),l=t(5).EventEmitter,c=t(71).gestureListener,d=t(68),h=t(37),p=e.exports=function(e){var r=void 0!==n&&n.versions&&n.versions.node,o=this;e=h.defaults(e||{},{inNode:r}),this.inNode=e.inNode,e=h.defaults(e||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0}),this.animationFrameRequested=!1,this.onAnimationFrame=function(t){o.lastConnectionFrame.valid&&o.emit("animationFrame",o.lastConnectionFrame),o.emit("frameEnd",t),o.loopWhileDisconnected&&(!1!==o.connection.focusedState||o.connection.opts.background)?window.requestAnimationFrame(o.onAnimationFrame):o.animationFrameRequested=!1},this.suppressAnimationLoop=e.suppressAnimationLoop,this.loopWhileDisconnected=e.loopWhileDisconnected,this.frameEventName=e.frameEventName,this.useAllPlugins=e.useAllPlugins,this.history=new s(200),this.lastFrame=i.Invalid,this.lastValidFrame=i.Invalid,this.lastConnectionFrame=i.Invalid,this.accumulatedGestures=[],this.checkVersion=e.checkVersion,void 0===e.connectionType?this.connectionType=t(this.inBrowser()?65:66):this.connectionType=e.connectionType,this.connection=new this.connectionType(e),this.streamingCount=0,this.devices={},this.plugins={},this._pluginPipelineSteps={},this._pluginExtendedMethods={},e.useAllPlugins&&this.useRegisteredPlugins(),this.setupFrameEvents(e),this.setupConnectionEvents(),this.startAnimationLoop()};p.prototype.gesture=function(t,e){var n=c(this,t);return void 0!==e&&n.stop(e),n},p.prototype.setBackground=function(t){return this.connection.setBackground(t),this},p.prototype.setOptimizeHMD=function(t){return this.connection.setOptimizeHMD(t),this},p.prototype.inBrowser=function(){return!this.inNode},p.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()},p.prototype.inBackgroundPage=function(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window},p.prototype.connect=function(){return this.connection.connect(),this},p.prototype.streaming=function(){return this.streamingCount>0},p.prototype.connected=function(){return!!this.connection.connected},p.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))},p.prototype.disconnect=function(){return this.connection.disconnect(),this},p.prototype.frame=function(t){return this.history.get(t)||i.Invalid},p.prototype.loop=function(t){return t&&("function"==typeof t?this.on(this.frameEventName,t):this.setupFrameEvents(t)),this.connect()},p.prototype.addStep=function(t){this.pipeline||(this.pipeline=new u(this)),this.pipeline.addStep(t)},p.prototype.processFrame=function(t){t.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(t.gestures)),this.lastConnectionFrame=t,this.startAnimationLoop(),this.emit("deviceFrame",t)},p.prototype.processFinishedFrame=function(t){if(this.lastFrame=t,t.valid&&(this.lastValidFrame=t),
t.controller=this,t.historyIdx=this.history.push(t),t.gestures){t.gestures=this.accumulatedGestures,this.accumulatedGestures=[];for(var e=0;e!=t.gestures.length;e++)this.emit("gesture",t.gestures[e],t)}this.pipeline&&((t=this.pipeline.run(t))||(t=i.Invalid)),this.emit("frame",t),this.emitHandEvents(t)},p.prototype.emitHandEvents=function(t){for(var e=0;e<t.hands.length;e++)this.emit("hand",t.hands[e])},p.prototype.setupFrameEvents=function(t){t.frame&&this.on("frame",t.frame),t.hand&&this.on("hand",t.hand)},p.prototype.setupConnectionEvents=function(){var t=this;this.connection.on("frame",function(e){t.processFrame(e)}),this.on(this.frameEventName,function(e){t.processFinishedFrame(e)});var e=function(){if(t.connection.opts.requestProtocolVersion<5&&0==t.streamingCount){t.streamingCount=1;var n={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};t.devices[n.id]=n,t.emit("deviceAttached",n),t.emit("deviceStreaming",n),t.emit("streamingStarted",n),t.connection.removeListener("frame",e)}},n=function(){if(t.streamingCount>0){for(var e in t.devices)t.emit("deviceStopped",t.devices[e]),t.emit("deviceRemoved",t.devices[e]);t.emit("streamingStopped",t.devices[e]),t.streamingCount=0;for(var e in t.devices)delete t.devices[e]}};this.connection.on("focus",function(){t.loopWhileDisconnected&&t.startAnimationLoop(),t.emit("focus")}),this.connection.on("blur",function(){t.emit("blur")}),this.connection.on("protocol",function(e){e.on("beforeFrameCreated",function(e){t.emit("beforeFrameCreated",e)}),e.on("afterFrameCreated",function(e,n){t.emit("afterFrameCreated",e,n)}),t.emit("protocol",e)}),this.connection.on("ready",function(){t.checkVersion&&!t.inNode&&t.checkOutOfDate(),t.emit("ready")}),this.connection.on("connect",function(){t.emit("connect"),t.connection.removeListener("frame",e),t.connection.on("frame",e)}),this.connection.on("disconnect",function(){t.emit("disconnect"),n()}),this.connection.on("deviceConnect",function(i){i.state?(t.emit("deviceConnected"),t.connection.removeListener("frame",e),t.connection.on("frame",e)):(t.emit("deviceDisconnected"),n())}),this.connection.on("deviceEvent",function(e){var n=e.state,i=t.devices[n.id],r={};for(var o in n)i&&i.hasOwnProperty(o)&&i[o]==n[o]||(r[o]=!0);t.devices[n.id]=n,r.attached&&t.emit(n.attached?"deviceAttached":"deviceRemoved",n),r.streaming&&(n.streaming?(t.streamingCount++,t.emit("deviceStreaming",n),1==t.streamingCount&&t.emit("streamingStarted",n),r.attached||t.emit("deviceConnected")):r.attached&&n.attached||(t.streamingCount--,t.emit("deviceStopped",n),0==t.streamingCount&&t.emit("streamingStopped",n),t.emit("deviceDisconnected")))}),this.on("newListener",function(t,e){"deviceConnected"!=t&&"deviceDisconnected"!=t||console.warn(t+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})},p.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var t=this.connection.protocol.serviceVersion,e=this.connection.protocol.version,n=this.connectionType.defaultProtocolVersion;return n>e&&(console.warn("Your Protocol Version is v"+e+", this app was designed for v"+n),d.warnOutOfDate({sV:t,pV:e}),!0)},p._pluginFactories={},p.plugin=function(t,e){return this._pluginFactories[t]&&console.warn('Plugin "'+t+'" already registered'),this._pluginFactories[t]=e},p.plugins=function(){return h.keys(this._pluginFactories)};var f=function(t,e,n){-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(e)?this.on(e,n):(this.pipeline||(this.pipeline=new u(this)),this._pluginPipelineSteps[t]||(this._pluginPipelineSteps[t]=[]),this._pluginPipelineSteps[t].push(this.pipeline.addWrappedStep(e,n)))},m=function(t,e,n){var s;switch(this._pluginExtendedMethods[t]||(this._pluginExtendedMethods[t]=[]),e){case"frame":s=i;break;case"hand":s=r;break;case"pointable":s=o,h.extend(a.prototype,n),h.extend(a.Invalid,n);break;case"finger":s=a;break;default:throw t+' specifies invalid object type "'+e+'" for prototypical extension'}h.extend(s.prototype,n),h.extend(s.Invalid,n),this._pluginExtendedMethods[t].push([s,n])};p.prototype.use=function(t,e){var n,i,r,o;if(!(i="function"==typeof t?t:p._pluginFactories[t]))throw"Leap Plugin "+t+" not found.";if(e||(e={}),this.plugins[t])return h.extend(this.plugins[t],e),this;this.plugins[t]=e,o=i.call(this,e);for(r in o)n=o[r],"function"==typeof n?f.call(this,t,r,n):m.call(this,t,r,n);return this},p.prototype.stopUsing=function(t){var e,n,i=this._pluginPipelineSteps[t],r=this._pluginExtendedMethods[t],o=0;if(this.plugins[t]){if(i)for(o=0;o<i.length;o++)this.pipeline.removeStep(i[o]);if(r)for(o=0;o<r.length;o++){e=r[o][0],n=r[o][1];for(var a in n)delete e.prototype[a],delete e.Invalid[a]}return delete this.plugins[t],this}},p.prototype.useRegisteredPlugins=function(){for(var t in p._pluginFactories)this.use(t)},h.extend(p.prototype,l.prototype)}).call(this,t(30))},{30:30,37:37,5:5,63:63,65:65,66:66,68:68,69:69,70:70,71:71,72:72,75:75,76:76}],68:[function(t,e,n){(function(t){var n=e.exports=function(t,e){this.options=e||{},this.message=t,this.createElement()};n.prototype.createElement=function(){this.element=document.createElement("div"),this.element.className="leapjs-dialog",this.element.style.position="fixed",this.element.style.top="8px",this.element.style.left=0,this.element.style.right=0,this.element.style.textAlign="center",this.element.style.zIndex=1e3;var t=document.createElement("div");this.element.appendChild(t),t.style.className="leapjs-dialog",t.style.display="inline-block",t.style.margin="auto",t.style.padding="8px",t.style.color="#222",t.style.background="#eee",t.style.borderRadius="4px",t.style.border="1px solid #999",t.style.textAlign="left",t.style.cursor="pointer",t.style.whiteSpace="nowrap",t.style.transition="box-shadow 1s linear",t.innerHTML=this.message,this.options.onclick&&t.addEventListener("click",this.options.onclick),this.options.onmouseover&&t.addEventListener("mouseover",this.options.onmouseover),this.options.onmouseout&&t.addEventListener("mouseout",this.options.onmouseout),this.options.onmousemove&&t.addEventListener("mousemove",this.options.onmousemove)},n.prototype.show=function(){return document.body.appendChild(this.element),this},n.prototype.hide=function(){return document.body.removeChild(this.element),this},n.warnOutOfDate=function(t){t||(t={});var e="http://developer.leapmotion.com?";t.returnTo=window.location.href;for(var i in t)e+=i+"="+encodeURIComponent(t[i])+"&";var r;return r=new n("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(t){if("leapjs-decline-upgrade"!=t.target.id){var n=window.open(e,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1");window.focus&&n.focus()}return r.hide(),!0},onmousemove:function(t){t.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}}),r.show()},n.hasWarnedBones=!1,n.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),void 0!==t&&t.versions&&t.versions.node||this.warnOutOfDate({reason:"bones"}))}}).call(this,t(30))},{30:30}],69:[function(t,e,n){var i=t(76),r=t(62),o=t(68),a=t(37),s=e.exports=function(t){i.call(this,t),this.dipPosition=t.dipPosition,this.pipPosition=t.pipPosition,this.mcpPosition=t.mcpPosition,this.carpPosition=t.carpPosition,this.extended=t.extended,this.type=t.type,this.finger=!0,this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition],t.bases?this.addBones(t):o.warnBones()};a.extend(s.prototype,i.prototype),s.prototype.addBones=function(t){this.metacarpal=new r(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:t.bases[0]}),this.proximal=new r(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:t.bases[1]}),this.medial=new r(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:t.bases[2]}),this.distal=new r(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:t.btipPosition,basis:t.bases[3]}),this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]},s.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},s.Invalid={valid:!1}},{37:37,62:62,68:68,76:76}],70:[function(t,e,n){var i=t(72),r=t(76),o=t(71).createGesture,a=t(6),s=a.mat3,u=a.vec3,l=t(74),c=t(69),d=t(37),h=e.exports=function(t){if(this.valid=!0,this.id=t.id,this.timestamp=t.timestamp,this.hands=[],this.handsMap={},this.pointables=[],this.tools=[],this.fingers=[],t.interactionBox&&(this.interactionBox=new l(t.interactionBox)),this.gestures=[],this.pointablesMap={},this._translation=t.t,this._rotation=d.flatten(t.r),this._scaleFactor=t.s,this.data=t,this.type="frame",this.currentFrameRate=t.currentFrameRate,t.gestures)for(var e=0,n=t.gestures.length;e!=n;e++)this.gestures.push(o(t.gestures[e]));this.postprocessData(t)};h.prototype.postprocessData=function(t){t||(t=this.data);for(var e=0,n=t.hands.length;e!=n;e++){var o=new i(t.hands[e]);o.frame=this,this.hands.push(o),this.handsMap[o.id]=o}t.pointables=d.sortBy(t.pointables,function(t){return t.id});for(var a=0,s=t.pointables.length;a!=s;a++){var u=t.pointables[a],l=u.dipPosition?new c(u):new r(u);l.frame=this,this.addPointable(l)}},h.prototype.addPointable=function(t){if(this.pointables.push(t),this.pointablesMap[t.id]=t,(t.tool?this.tools:this.fingers).push(t),void 0!==t.handId&&this.handsMap.hasOwnProperty(t.handId)){var e=this.handsMap[t.handId];switch(e.pointables.push(t),(t.tool?e.tools:e.fingers).push(t),t.type){case 0:e.thumb=t;break;case 1:e.indexFinger=t;break;case 2:e.middleFinger=t;break;case 3:e.ringFinger=t;break;case 4:e.pinky=t}}},h.prototype.tool=function(t){var e=this.pointable(t);return e.tool?e:r.Invalid},h.prototype.pointable=function(t){return this.pointablesMap[t]||r.Invalid},h.prototype.finger=function(t){var e=this.pointable(t);return e.tool?r.Invalid:e},h.prototype.hand=function(t){return this.handsMap[t]||i.Invalid},h.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var n=this.rotationMatrix(t),i=.5*(n[0]+n[4]+n[8]-1),r=Math.acos(i);if(r=isNaN(r)?0:r,void 0!==e){var o=this.rotationAxis(t);r*=u.dot(o,u.normalize(u.create(),e))}return r},h.prototype.rotationAxis=function(t){return this.valid&&t.valid?u.normalize(u.create(),[this._rotation[7]-t._rotation[5],this._rotation[2]-t._rotation[6],this._rotation[3]-t._rotation[1]]):u.create()},h.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return s.create();var e=s.transpose(s.create(),this._rotation);return s.multiply(s.create(),t._rotation,e)},h.prototype.scaleFactor=function(t){return this.valid&&t.valid?Math.exp(this._scaleFactor-t._scaleFactor):1},h.prototype.translation=function(t){return this.valid&&t.valid?u.subtract(u.create(),this._translation,t._translation):u.create()},h.prototype.toString=function(){var t="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";return this.gestures&&(t+=" | Gesture count:("+this.gestures.length+")"),t+=" ]"},h.prototype.dump=function(){var t="";t+="Frame Info:<br/>",t+=this.toString(),t+="<br/><br/>Hands:<br/>";for(var e=0,n=this.hands.length;e!=n;e++)t+="  "+this.hands[e].toString()+"<br/>";t+="<br/><br/>Pointables:<br/>";for(var i=0,r=this.pointables.length;i!=r;i++)t+="  "+this.pointables[i].toString()+"<br/>";if(this.gestures){t+="<br/><br/>Gestures:<br/>";for(var o=0,a=this.gestures.length;o!=a;o++)t+="  "+this.gestures[o].toString()+"<br/>"}return t+="<br/><br/>Raw JSON:<br/>",t+=JSON.stringify(this.data)},h.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return r.Invalid},finger:function(){return r.Invalid},hand:function(){return i.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return s.create()},rotationAxis:function(){return u.create()},scaleFactor:function(){return 1},translation:function(){return u.create()}}},{37:37,6:6,69:69,71:71,72:72,74:74,76:76}],71:[function(t,e,n){var i=t(6),r=i.vec3,o=t(5).EventEmitter,a=t(37),s=(n.createGesture=function(t){var e;switch(t.type){case"circle":e=new u(t);break;case"swipe":e=new l(t);break;case"screenTap":e=new c(t);break;case"keyTap":e=new d(t);break;default:throw"unknown gesture type"}return e.id=t.id,e.handIds=t.handIds.slice(),e.pointableIds=t.pointableIds.slice(),e.duration=t.duration,e.state=t.state,e.type=t.type,e},n.gestureListener=function(t,e){var n={},i={};t.on("gesture",function(t,r){if(t.type==e){if(("start"==t.state||"stop"==t.state)&&void 0===i[t.id]){var o=new s(t,r);i[t.id]=o,a.each(n,function(t,e){o.on(e,t)})}i[t.id].update(t,r),"stop"==t.state&&delete i[t.id]}});var r={start:function(t){return n.start=t,r},stop:function(t){return n.stop=t,r},complete:function(t){return n.stop=t,r},update:function(t){return n.update=t,r}};return r},n.Gesture=function(t,e){this.gestures=[t],this.frames=[e]});s.prototype.update=function(t,e){this.lastGesture=t,this.lastFrame=e,this.gestures.push(t),this.frames.push(e),this.emit(t.state,this)},s.prototype.translation=function(){return r.subtract(r.create(),this.lastGesture.startPosition,this.lastGesture.position)},a.extend(s.prototype,o.prototype);var u=function(t){this.center=t.center,this.normal=t.normal,this.progress=t.progress,this.radius=t.radius};u.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var l=function(t){this.startPosition=t.startPosition,this.position=t.position,this.direction=t.direction,this.speed=t.speed};l.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var c=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};c.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var d=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};d.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"}},{37:37,5:5,6:6}],72:[function(t,e,n){var i=t(76),r=t(62),o=t(6),a=o.mat3,s=o.vec3,u=t(37),l=e.exports=function(t){this.id=t.id,this.palmPosition=t.palmPosition,this.direction=t.direction,this.palmVelocity=t.palmVelocity,this.palmNormal=t.palmNormal,this.sphereCenter=t.sphereCenter,this.sphereRadius=t.sphereRadius,this.valid=!0,this.pointables=[],this.fingers=[],t.armBasis?this.arm=new r(this,{type:4,width:t.armWidth,prevJoint:t.elbow,nextJoint:t.wrist,basis:t.armBasis}):this.arm=null,this.tools=[],this._translation=t.t,this._rotation=u.flatten(t.r),this._scaleFactor=t.s,this.timeVisible=t.timeVisible,this.stabilizedPalmPosition=t.stabilizedPalmPosition,this.type=t.type,this.grabStrength=t.grabStrength,this.pinchStrength=t.pinchStrength,this.confidence=t.confidence};l.prototype.finger=function(t){var e=this.frame.finger(t);return e&&e.handId==this.id?e:i.Invalid},l.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;if(!t.hand(this.id).valid)return 0;var n=this.rotationMatrix(t),i=.5*(n[0]+n[4]+n[8]-1),r=Math.acos(i);if(r=isNaN(r)?0:r,void 0!==e){var o=this.rotationAxis(t);r*=s.dot(o,s.normalize(s.create(),e))}return r},l.prototype.rotationAxis=function(t){if(!this.valid||!t.valid)return s.create();var e=t.hand(this.id);return e.valid?s.normalize(s.create(),[this._rotation[7]-e._rotation[5],this._rotation[2]-e._rotation[6],this._rotation[3]-e._rotation[1]]):s.create()},l.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return a.create();var e=t.hand(this.id);if(!e.valid)return a.create();var n=a.transpose(a.create(),this._rotation);return a.multiply(a.create(),e._rotation,n)},l.prototype.scaleFactor=function(t){if(!this.valid||!t.valid)return 1;var e=t.hand(this.id);return e.valid?Math.exp(this._scaleFactor-e._scaleFactor):1},l.prototype.translation=function(t){if(!this.valid||!t.valid)return s.create();var e=t.hand(this.id);return e.valid?[this._translation[0]-e._translation[0],this._translation[1]-e._translation[1],this._translation[2]-e._translation[2]]:s.create()},l.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "},l.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])},l.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])},l.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])},l.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return i.Invalid},finger:function(){return i.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return a.create()},rotationAxis:function(){return s.create()},scaleFactor:function(){return 1},translation:function(){return s.create()}}},{37:37,6:6,62:62,76:76}],73:[function(t,e,n){e.exports={Controller:t(67),Frame:t(70),Gesture:t(71),Hand:t(72),Pointable:t(76),Finger:t(69),InteractionBox:t(74),CircularBuffer:t(63),UI:t(78),JSONProtocol:t(77).JSONProtocol,glMatrix:t(6),mat3:t(6).mat3,vec3:t(6).vec3,loopController:void 0,version:t(81),_:t(37),EventEmitter:t(5).EventEmitter,loop:function(t,e){return t&&void 0===e&&"[object Function]"==={}.toString.call(t)&&(e=t,t={}),this.loopController?t&&this.loopController.setupFrameEvents(t):this.loopController=new this.Controller(t),this.loopController.loop(e),this.loopController},plugin:function(t,e){this.Controller.plugin(t,e)}}},{37:37,5:5,6:6,63:63,67:67,69:69,70:70,71:71,72:72,74:74,76:76,77:77,78:78,81:81}],74:[function(t,e,n){var i=t(6),r=i.vec3,o=e.exports=function(t){this.valid=!0,this.center=t.center,this.size=t.size,this.width=t.size[0],this.height=t.size[1],this.depth=t.size[2]};o.prototype.denormalizePoint=function(t){return r.fromValues((t[0]-.5)*this.size[0]+this.center[0],(t[1]-.5)*this.size[1]+this.center[1],(t[2]-.5)*this.size[2]+this.center[2])},o.prototype.normalizePoint=function(t,e){var n=r.fromValues((t[0]-this.center[0])/this.size[0]+.5,(t[1]-this.center[1])/this.size[1]+.5,(t[2]-this.center[2])/this.size[2]+.5);return e&&(n[0]=Math.min(Math.max(n[0],0),1),n[1]=Math.min(Math.max(n[1],0),1),n[2]=Math.min(Math.max(n[2],0),1)),n},o.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"},o.Invalid={valid:!1}},{6:6}],75:[function(t,e,n){var i=e.exports=function(t){this.steps=[],this.controller=t};i.prototype.addStep=function(t){this.steps.push(t)},i.prototype.run=function(t){for(var e=this.steps.length,n=0;n!=e&&t;n++)t=this.steps[n](t);return t},i.prototype.removeStep=function(t){var e=this.steps.indexOf(t);if(-1===e)throw"Step not found in pipeline";this.steps.splice(e,1)},i.prototype.addWrappedStep=function(t,e){var n=this.controller,i=function(i){var r,o,a;for(r="frame"==t?[i]:i[t+"s"]||[],o=0,a=r.length;o<a;o++)e.call(n,r[o]);return i};return this.addStep(i),i}},{}],76:[function(t,e,n){var i=t(6),r=(i.vec3,e.exports=function(t){this.valid=!0,this.id=t.id,this.handId=t.handId,this.length=t.length,this.tool=t.tool,this.width=t.width,this.direction=t.direction,this.stabilizedTipPosition=t.stabilizedTipPosition,this.tipPosition=t.tipPosition,this.tipVelocity=t.tipVelocity,this.touchZone=t.touchZone,this.touchDistance=t.touchDistance,this.timeVisible=t.timeVisible});r.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},r.prototype.hand=function(){return this.frame.hand(this.handId)},r.Invalid={valid:!1}},{6:6}],77:[function(t,e,n){var i=t(70),r=(t(72),t(76),t(69),t(37)),o=t(5).EventEmitter,a=function(t){this.type=t.type,this.state=t.state};n.chooseProtocol=function(t){var e;switch(t.version){case 1:case 2:case 3:case 4:case 5:case 6:e=s(t),e.sendBackground=function(t,n){t.send(e.encode({background:n}))},e.sendFocused=function(t,n){t.send(e.encode({focused:n}))},e.sendOptimizeHMD=function(t,n){t.send(e.encode({optimizeHMD:n}))};break;default:throw"unrecognized version"}return e};var s=n.JSONProtocol=function(t){var e=function(t){if(t.event)return new a(t.event);e.emit("beforeFrameCreated",t);var n=new i(t);return e.emit("afterFrameCreated",n,t),n};return e.encode=function(t){return JSON.stringify(t)},e.version=t.version,e.serviceVersion=t.serviceVersion,e.versionLong="Version "+t.version,e.type="protocol",r.extend(e,o.prototype),e}},{37:37,5:5,69:69,70:70,72:72,76:76}],78:[function(t,e,n){n.UI={Region:t(80),Cursor:t(79)}},{79:79,80:80}],79:[function(t,e,n){e.exports=function(){return function(t){var e=t.pointables.sort(function(t,e){return t.z-e.z})[0];return e&&e.valid&&(t.cursorPosition=e.tipPosition),t}}},{}],80:[function(t,e,n){var i=t(5).EventEmitter,r=t(37),o=e.exports=function(t,e){this.start=new Vector(t),this.end=new Vector(e),this.enteredFrame=null};o.prototype.hasPointables=function(t){for(var e=0;e!=t.pointables.length;e++){var n=t.pointables[e].tipPosition;if(n.x>=this.start.x&&n.x<=this.end.x&&n.y>=this.start.y&&n.y<=this.end.y&&n.z>=this.start.z&&n.z<=this.end.z)return!0}return!1},o.prototype.listener=function(t){var e=this;return t&&t.nearThreshold&&this.setupNearRegion(t.nearThreshold),function(t){return e.updatePosition(t)}},o.prototype.clipper=function(){var t=this;return function(e){return t.updatePosition(e),t.enteredFrame?e:null}},o.prototype.setupNearRegion=function(t){var e=this.nearRegion=new o([this.start.x-t,this.start.y-t,this.start.z-t],[this.end.x+t,this.end.y+t,this.end.z+t]),n=this;e.on("enter",function(t){n.emit("near",t)}),e.on("exit",function(t){n.emit("far",t)}),n.on("exit",function(t){n.emit("near",t)})},o.prototype.updatePosition=function(t){return this.nearRegion&&this.nearRegion.updatePosition(t),this.hasPointables(t)&&null==this.enteredFrame?(this.enteredFrame=t,this.emit("enter",this.enteredFrame)):this.hasPointables(t)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame)),t},o.prototype.normalize=function(t){return new Vector([(t.x-this.start.x)/(this.end.x-this.start.x),(t.y-this.start.y)/(this.end.y-this.start.y),(t.z-this.start.z)/(this.end.z-this.start.z)])},o.prototype.mapToXY=function(t,e,n){var i=this.normalize(t),r=i.x,o=i.y;return r>1?r=1:r<-1&&(r=-1),o>1?o=1:o<-1&&(o=-1),[(r+1)/2*e,(1-o)/2*n,i.z]},r.extend(o.prototype,i.prototype)},{37:37,5:5}],81:[function(t,e,n){e.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}]},{},[42]);